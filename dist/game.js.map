{"version":3,"sources":["webpack:///webpack/bootstrap a45ded69784e74e01b9e","webpack:///./src/consts.js","webpack:///./src/buttons.js","webpack:///./src/animate.js","webpack:///./src/texts.js","webpack:///./src/game.js","webpack:///./src/simple-gl/index.js","webpack:///./src/simple-gl/rect.v.glsl","webpack:///./src/simple-gl/rect.f.glsl","webpack:///./src/tiles.js","webpack:///./src/dot-fonts/letters.js","webpack:///./src/dot-fonts/numbers.js","webpack:///./src/dot-fonts/symbols.js","webpack:///./src/dot-fonts/special.js","webpack:///./src/cover.js","webpack:///./src/levels/tutorial-1.js","webpack:///./src/levels/tutorial-2.js","webpack:///./src/levels/tutorial-3.js","webpack:///./src/generator.js","webpack:///./src/dot-fonts/chinese.js","webpack:///./src/share.js"],"names":["COLOR_R","COLOR_G","COLOR_B","transformColorStr","colorStr","r","parseInt","slice","g","b","COLOR_R_ARR","COLOR_G_ARR","COLOR_B_ARR","COLOR_BG_ARR","COLOR_BTN_NORMAL_ARR","COLOR_BTN_ACTIVE_ARR","COLOR_BTN_FLASH_ARR","R","G","B","MAP_LETTER_NUM_MAP","y","c","p","w","FLASH_ANIMATION_LENGTH","createButton","stage","h","margin","cb","container","createContainer","append","createRect","color","bind","activateButton","index","deactivateButton","flashButton","buttonFlashing","btn","setAlpha","curAlpha","flash","x","alpha","unflashButton","animateObj","obj","toPos","length","fromX","fromY","fromAlpha","toX","toY","toAlpha","endTime","Date","now","updateFunc","time","timeLeft","ratio","Math","sqrt","requestAnimationFrame","dotsPositions","Object","create","dotsInfo","prepareFonts","letter","dotStr","lines","split","indexOf","shift","left","right","infoArr","JSON","parse","info","width","height","n","arr","lineContent","m","push","k","createTexts","str","size","i","dotsPosArr","dotSize","forEach","rect","tileUtils","changeOrientation","isVertical","init","canvas","options","root","getRootContainer","mainContainer","coverContainer","coverUtils","onSelect","type","clear","levels","nextLevel","item","showCover","loadLevel","timeUsed","stepCount","quit","seed","floor","random","levelNum","level","window","open","shareInfo","rectVs","require","rectFs","createVertexShader","gl","src","shaderLog","shader","createShader","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","Error","createFragmentShader","FRAGMENT_SHADER","createShaderProgram","vs","fs","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","SimpleAttribBuffer","attribName","count","_gl","_size","_count","glBuf","_glBuf","createBuffer","buf","_buf","Float32Array","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","attribLocation","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","SimpleUniform","uniformName","_loc","getUniformLocation","z","uniform1f","uniform2f","uniform3f","uniform4f","SimpleGLObject","simpleGL","_bindings","s","d","_blendMode","_triggerBinding","blendMode","blendColor","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","name","detail","func","call","pos","_handleEvent","SimpleRect","useProgram","uCanvasSize","_width","_height","_rectGL","aPoint","uColor","_simpleGL","a","relX","relY","relAlpha","_prepareObject","getFloat32Array","write","set","drawArrays","TRIANGLE_FAN","SimpleContainer","_children","child","unshift","before","splice","node","_draw","SimpleGL","getContext","enable","BLEND","viewport","clearColor","clearDepth","_canvas","_rootContainer","_init","setAutoUpdate","status","_autoUpdate","checkUpdate","_scheduledChecking","update","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","args","userClickEnabled","userColor","map","originalMapJSON","steps","startTime","timeTobj","currentTutorialStep","tutorialSteps","levelEndCb","tilesContainer","TILE_AREA_MARGIN","bgContainer","fgContainer","animateContainer","tutorialContainer","metaContainer","colorHintContainer","levelInfoContainer","menuContainer","userColorSelectContainer","drawBackground","j","M_N_MAX","toPixelPos","tile","TILE_SIZE","handleUserClick","initTileContainers","singleTileContainer","refreshTiles","num","tileType","colorSelectButtons","colorHints","stepCounterContainer","resetMetaContainer","TITLE_SIZE","TIME_SIZE","TITLE_COLOR_ARR","showTitle","titleText","maxColor","titleContainer","timeContainer","showTime","timeDiff","minuteStr","secondStr","String","setInterval","updateStepCounter","showMenuButtons","shareButton","shareText","resetButton","resetLevel","resetText","quitButton","endLevel","quitText","showMapInfo","mapInfoContainer","refreshColorSelectButtons","drawColorHint","SIZE","INTERVAL","INITIAL_X","rowOffset","text","endX","drawUserColorSelect","SPACING","BORDER_SIZE","btns","acceptUserClick","findTileRectByColor","forEachChild","cloneRect","ret","checkColorToAdj","toM","toN","srcRect","srcPos","midPos","oldRect","remove","ANIMATION_LENGTH","eraseColor","checkLevelEnd","addColor","colorArr","from","to","parseLevelStr","mapStr","stringify","hasR","hasG","hasB","title","difficulty","clearInterval","TILE_MARGIN","tileBetween","signs","match","line","A","C","D","E","F","H","I","J","K","L","M","N","O","P","Q","S","T","U","V","W","X","Y","Z","language","selectCb","titleLineContainer","block1","block2","block3","block41","block42","block51","block52","block61","block62","block71","block72","block73","title1","title2","title3","title4","tutorialButton","tutorialText1","tutorialText2","endlessContainer","endlessButton","endlessText1","endlessText2","authorContainer","authorText","authorTextBg","D_PER_LEVEL","D_COLOR_COUNT","D_STEP_BATCH","D_STEP_SAME_POINT","P_SYMMETRY_NONE","P_SYMMETRY_H","P_SYMMETRY_V","P_SYMMETRY_ROTATE","P_SYMMETRY_ALL","P_SYMMETRY_ALL_ROTATE","P_SYMMETRY_NONE_INC","P_SYMMETRY_H_INC","P_SYMMETRY_V_INC","P_SYMMETRY_ROTATE_INC","P_SYMMETRY_ALL_INC","P_SYMMETRY_ALL_ROTATE_INC","SYMMETRY_INC_LEVELS","FAIL_STEP","P_2_COLOR_D_MIN","P_3_COLOR_D_MIN","P_2_COLOR_D_INC","P_3_COLOR_D_INC","SYMMETRY_NONE","SYMMETRY_H","SYMMETRY_V","SYMMETRY_ROTATE","SYMMETRY_ALL","SYMMETRY_ALL_ROTATE","levelToDifficulty","endless","curSeed","curRandMul","getRandom","max","prevRandMul","colorMap","opCountMap","symmetryRand","symmetryType","symmetryIncLevels","min","colorKey","colorRand","colors","colorType","pColor2","pColor3","currentD","nextStep","stepColor","availablePos","stepM","stepN","stepSamePoint","signMap","weightMap","setSignMap","stepD","allowFailStep","levelObj","SHARE_STR_VERSION","toHexStr","bytes","toString","createShareStr","salt","slices","join","parseShareStr","version","examing","shareLevel","location","protocol","host","pathname","search","getShareInfo","hash"],"mappings":"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","file":"game.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a45ded69784e74e01b9e","const COLOR_R = '#e75885'\r\nconst COLOR_G = '#2f9134'\r\nconst COLOR_B = '#228eda'\r\n\r\nconst transformColorStr = (colorStr) => {\r\n  const r = parseInt(colorStr.slice(1, 3), 16) / 255\r\n  const g = parseInt(colorStr.slice(3, 5), 16) / 255\r\n  const b = parseInt(colorStr.slice(5, 7), 16) / 255\r\n  return [r, g, b, 0.7]\r\n}\r\nexport const COLOR_R_ARR = transformColorStr(COLOR_R)\r\nexport const COLOR_G_ARR = transformColorStr(COLOR_G)\r\nexport const COLOR_B_ARR = transformColorStr(COLOR_B)\r\nexport const COLOR_BG_ARR = [0.1, 0.1, 0.1, 1]\r\n\r\nexport const COLOR_BTN_NORMAL_ARR = [0.2, 0.2, 0.2, 1]\r\nexport const COLOR_BTN_ACTIVE_ARR = [0.6, 0.6, 0.6, 1]\r\nexport const COLOR_BTN_FLASH_ARR = [0.9, 0.9, 0.9, 1]\r\n\r\nexport const R = 1\r\nexport const G = 2\r\nexport const B = 4\r\n\r\nexport const MAP_LETTER_NUM_MAP = {\r\n  '-': 0,\r\n  r: R,\r\n  g: G,\r\n  b: B,\r\n  y: R | G,\r\n  c: G | B,\r\n  p: R | B,\r\n  w: R | G | B,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/consts.js","import {\r\n  COLOR_BG_ARR,\r\n  COLOR_BTN_NORMAL_ARR,\r\n  COLOR_BTN_ACTIVE_ARR,\r\n  COLOR_BTN_FLASH_ARR,\r\n} from './consts'\r\nimport { animateObj } from './animate'\r\n\r\nconst FLASH_ANIMATION_LENGTH = 1000\r\n\r\nexport const createButton = (stage, w, h, margin, cb) => {\r\n  const container = stage.createContainer()\r\n  container.append(stage.createRect(-margin, -margin, w + margin * 2, h + margin * 2).color(...COLOR_BTN_NORMAL_ARR).bind('click', cb || function() { /* empty */ }))\r\n  container.append(stage.createRect(0, 0, w, h).color(...COLOR_BG_ARR))\r\n  return container\r\n}\r\nexport const activateButton = (container) => {\r\n  container.index(0).color(...COLOR_BTN_ACTIVE_ARR)\r\n}\r\nexport const deactivateButton = (container) => {\r\n  container.index(0).color(...COLOR_BTN_NORMAL_ARR)\r\n}\r\nexport const flashButton = (container) => {\r\n  if (container.buttonFlashing) return\r\n  container.buttonFlashing = true\r\n  const btn = container.index(0).color(...COLOR_BTN_FLASH_ARR).setAlpha(0)\r\n  let curAlpha = 0\r\n  const flash = () => {\r\n    if (!container.buttonFlashing) {\r\n      activateButton(container)\r\n      return\r\n    }\r\n    curAlpha = 1 - curAlpha\r\n    animateObj(btn, {\r\n      x: btn.x,\r\n      y: btn.y,\r\n      alpha: curAlpha\r\n    }, FLASH_ANIMATION_LENGTH, flash)\r\n  }\r\n  flash()\r\n}\r\nexport const unflashButton = (container) => {\r\n  container.buttonFlashing = false\r\n  container.index(0).color(...COLOR_BTN_NORMAL_ARR)\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/buttons.js","export const animateObj = (obj, toPos, length, cb) => {\r\n  const fromX = obj.x\r\n  const fromY = obj.y\r\n  const fromAlpha = obj.alpha\r\n  const toX = toPos.x\r\n  const toY = toPos.y\r\n  const toAlpha = toPos.alpha\r\n  const endTime = Date.now() + length\r\n  const updateFunc = () => {\r\n    const time = Date.now()\r\n    const timeLeft = endTime - time > 0 ? endTime - time : 0\r\n    const ratio = 1 - Math.sqrt(1 - timeLeft / length)\r\n    const x = toX - ratio * (toX - fromX)\r\n    const y = toY - ratio * (toY - fromY)\r\n    const alpha = toAlpha - ratio * (toAlpha - fromAlpha)\r\n    obj.x = x\r\n    obj.y = y\r\n    obj.alpha = alpha\r\n    if (timeLeft) requestAnimationFrame(updateFunc)\r\n    else if (cb) return cb()\r\n  }\r\n  requestAnimationFrame(updateFunc)\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/animate.js","import LETTERS from './dot-fonts/letters'\r\nimport NUMBERS from './dot-fonts/numbers'\r\nimport SYMBOLS from './dot-fonts/symbols'\r\nimport SPECIAL from './dot-fonts/special'\r\nimport CHINESE from './dot-fonts/chinese'\r\n\r\nconst dotsPositions = Object.create(null)\r\nconst dotsInfo = Object.create(null)\r\n\r\nconst prepareFonts = (letter, dotStr) => {\r\n  const lines = dotStr.split('\\n')\r\n  while(lines[0].indexOf('[') < 0) lines.shift()\r\n  const left = lines[0].indexOf('[')\r\n  const right = lines[0].indexOf(']') + 1\r\n  const infoArr = JSON.parse(lines[0].slice(left, right))\r\n  const info = {width: infoArr[0], height: infoArr[1]}\r\n  let n = 0\r\n  const arr = []\r\n  for(lines.shift(); lines.length; lines.shift(), n++) {\r\n    const lineContent = lines[0].slice(left, left + info.width)\r\n    for(let m = 0; m < lineContent.length; m++) {\r\n      if (lineContent[m] === '+') {\r\n        arr.push([m, n])\r\n      }\r\n    }\r\n  }\r\n  dotsPositions[letter] = arr\r\n  dotsInfo[letter] = info\r\n}\r\nfor(let k in LETTERS) prepareFonts(k, LETTERS[k])\r\nfor(let k in NUMBERS) prepareFonts(k, NUMBERS[k])\r\nfor(let k in SYMBOLS) prepareFonts(k, SYMBOLS[k])\r\nfor(let k in SPECIAL) prepareFonts(k, SPECIAL[k])\r\nfor(let k in CHINESE) prepareFonts(k, CHINESE[k])\r\n\r\nexport const createTexts = (stage, str, size, color) => {\r\n  const container = stage.createContainer()\r\n  let x = 0\r\n  for(let i = 0; i < str.length; i++) {\r\n    const dotsPosArr = dotsPositions[str[i]]\r\n    const info = dotsInfo[str[i]]\r\n    const dotSize = size / info.height\r\n    // eslint-disable-next-line no-loop-func\r\n    dotsPosArr.forEach(([m, n]) => {\r\n      const rect = stage.createRect(m * dotSize + x, n * dotSize, dotSize, dotSize).color(...color)\r\n      container.append(rect)\r\n    })\r\n    x += dotSize * info.width\r\n  }\r\n  return container\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/texts.js","import { SimpleGL } from './simple-gl'\r\nimport tiles from './tiles'\r\nimport cover from './cover'\r\nimport TUTORIAL_1 from './levels/tutorial-1'\r\nimport TUTORIAL_2 from './levels/tutorial-2'\r\nimport TUTORIAL_3 from './levels/tutorial-3'\r\nimport { endless } from './generator'\r\nimport { getShareInfo } from './share'\r\n\r\nlet tileUtils = null\r\n\r\n/* eslint-disable no-use-before-define */\r\n\r\nexport const changeOrientation = (isVertical) => {\r\n  tileUtils.changeOrientation(isVertical)\r\n}\r\n\r\nexport const init = (canvas, options) => {\r\n  const {isVertical} = options\r\n  const stage = new SimpleGL(canvas)\r\n  const root = stage.getRootContainer()\r\n\r\n  // init main container for tiles\r\n  const mainContainer = stage.createContainer()\r\n  tileUtils = tiles(stage, mainContainer)\r\n  if (isVertical) tileUtils.changeOrientation(isVertical)\r\n\r\n  // init cover\r\n  const coverContainer = stage.createContainer()\r\n  const coverUtils = cover(stage, coverContainer, options)\r\n  if (isVertical) coverUtils.changeOrientation(isVertical)\r\n  coverUtils.onSelect((type) => {\r\n    if (type === 'tutorial') {\r\n      root.clear().append(mainContainer)\r\n      const levels = [TUTORIAL_1(), TUTORIAL_2(), TUTORIAL_3()]\r\n      const nextLevel = (item) => {\r\n        if (!levels.length) return showCover()\r\n        tileUtils.loadLevel(levels.shift(), ({timeUsed, stepCount, quit}) => {\r\n          if (quit) return showCover()\r\n          nextLevel()\r\n        })\r\n      }\r\n      nextLevel()\r\n    } else if (type === 'endless') {\r\n      const seed = Math.floor(Math.random() * (1000000000))\r\n      let levelNum = 0\r\n      root.clear().append(mainContainer)\r\n      const nextLevel = ({timeUsed, stepCount, quit}) => {\r\n        if (quit) return showCover()\r\n        tileUtils.loadLevel(endless({\r\n          seed,\r\n          level: ++levelNum,\r\n          stepCount,\r\n          timeUsed\r\n        }), nextLevel)\r\n      }\r\n      nextLevel({\r\n        timeUsed: 0\r\n      })\r\n    } else {\r\n      window.open('https://github.com/LastLeaf/tricolors')\r\n    }\r\n  })\r\n\r\n  const showCover = () => {\r\n    root.clear().append(coverContainer)\r\n  }\r\n\r\n  const shareInfo = getShareInfo()\r\n  if (!shareInfo) {\r\n    showCover()\r\n  } else {\r\n    let {seed, levelNum, timeUsed, stepCount} = shareInfo\r\n    levelNum--\r\n    root.clear().append(mainContainer)\r\n    const nextLevel = ({timeUsed, stepCount, quit}) => {\r\n      if (quit) return showCover()\r\n      tileUtils.loadLevel(endless({\r\n        seed,\r\n        level: ++levelNum,\r\n        stepCount,\r\n        timeUsed\r\n      }), nextLevel)\r\n    }\r\n    nextLevel({\r\n      timeUsed,\r\n      stepCount\r\n    })\r\n  }\r\n\r\n  return stage\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/game.js","const rectVs = require('./rect.v.glsl')\r\nconst rectFs = require('./rect.f.glsl')\r\n\r\nconst createVertexShader = (gl, src) => {\r\n  let shaderLog = ''\r\n  const shader = gl.createShader(gl.VERTEX_SHADER)\r\n  gl.shaderSource(shader, src)\r\n  gl.compileShader(shader)\r\n  if(!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n    shaderLog = gl.getShaderInfoLog(shader)\r\n    gl.deleteShader(shader)\r\n    throw new Error('Failed initializing WebGL vertex shader: ' + shaderLog)\r\n  }\r\n  return shader\r\n}\r\n\r\nconst createFragmentShader = (gl, src) => {\r\n  let shaderLog = ''\r\n  const shader = gl.createShader(gl.FRAGMENT_SHADER)\r\n  gl.shaderSource(shader, src)\r\n  gl.compileShader(shader)\r\n  if(!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n    shaderLog = gl.getShaderInfoLog(shader)\r\n    gl.deleteShader(shader)\r\n    throw new Error('Failed initializing WebGL fragment shader: ' + shaderLog)\r\n  }\r\n  return shader\r\n}\r\n\r\nconst createShaderProgram = (gl, vs, fs) => {\r\n  var shaderProgram = gl.createProgram()\r\n  gl.attachShader(shaderProgram, vs)\r\n  gl.attachShader(shaderProgram, fs)\r\n  gl.linkProgram(shaderProgram)\r\n  if(!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\r\n    throw new Error('Failed initializing WebGL shader program.')\r\n  }\r\n  return shaderProgram\r\n}\r\n\r\nclass SimpleAttribBuffer {\r\n  constructor(gl, shaderProgram, attribName, size, count) {\r\n    this._gl = gl\r\n    this._size = size\r\n    this._count = count\r\n    const glBuf = this._glBuf = gl.createBuffer()\r\n    const buf = this._buf = new window.Float32Array(size * count)\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, glBuf)\r\n    gl.bufferData(gl.ARRAY_BUFFER, buf, gl.DYNAMIC_DRAW)\r\n    const attribLocation = gl.getAttribLocation(shaderProgram, attribName)\r\n    gl.enableVertexAttribArray(attribLocation)\r\n    gl.vertexAttribPointer(attribLocation, size, gl.FLOAT, false, 0, 0)\r\n  }\r\n  getFloat32Array() {\r\n    return this._buf\r\n  }\r\n  write() {\r\n    const gl = this._gl\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, this._glBuf)\r\n    gl.bufferData(gl.ARRAY_BUFFER, this._buf, gl.DYNAMIC_DRAW)\r\n  }\r\n}\r\n\r\nclass SimpleUniform {\r\n  constructor(gl, shaderProgram, uniformName, size) {\r\n    this._gl = gl\r\n    this._size = size\r\n    this._loc = gl.getUniformLocation(shaderProgram, uniformName)\r\n  }\r\n  set(x, y, z, w) {\r\n    const gl = this._gl\r\n    const size = this._size\r\n    if (size === 1) {\r\n      gl.uniform1f(this._loc, x)\r\n    } else if (size === 2) {\r\n      gl.uniform2f(this._loc, x, y)\r\n    } else if (size === 3) {\r\n      gl.uniform3f(this._loc, x, y, z)\r\n    } else {\r\n      gl.uniform4f(this._loc, x, y, z, w)\r\n    }\r\n  }\r\n}\r\n\r\nclass SimpleGLObject {\r\n  constructor(simpleGL) {\r\n    this._gl = simpleGL._gl\r\n    this.alpha = 1\r\n    this._bindings = Object.create(null)\r\n  }\r\n  setAlpha(alpha) {\r\n    this.alpha = alpha\r\n    return this\r\n  }\r\n  blendMode(s, d, c) {\r\n    const gl = this._gl\r\n    this._blendMode = [gl[s], gl[d], c]\r\n    return this\r\n  }\r\n  _prepareObject() {\r\n    const gl = this._gl\r\n    this._triggerBinding('draw')\r\n    const blendMode = this._blendMode\r\n    if (blendMode) {\r\n      if(blendMode[2]) gl.blendColor(blendMode[2][0], blendMode[2][1], blendMode[2][2], blendMode[2][3])\r\n      gl.blendFunc(blendMode[0], blendMode[1])\r\n    } else {\r\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA)\r\n    }\r\n  }\r\n  bind(name, cb) {\r\n    if (!this._bindings[name]) {\r\n      this._bindings[name] = [cb]\r\n    } else {\r\n      this._bindings[name].push(cb)\r\n    }\r\n    return this\r\n  }\r\n  _triggerBinding(name, detail) {\r\n    const arr = this._bindings[name]\r\n    if (!arr) return\r\n    arr.forEach((func) => {\r\n      func.call(this, detail)\r\n    })\r\n  }\r\n  emit(pos, name, detail) {\r\n    this._handleEvent(pos, name, detail)\r\n  }\r\n  // eslint-disable-next-line class-methods-use-this\r\n  _handleEvent(pos, name, detail) {\r\n    throw new Error('Not implemented')\r\n  }\r\n}\r\n\r\nclass SimpleRect extends SimpleGLObject {\r\n  static _init(simpleGL) {\r\n    const gl = simpleGL._gl\r\n    const vs = createVertexShader(gl, rectVs)\r\n    const fs = createFragmentShader(gl, rectFs)\r\n    const shaderProgram = createShaderProgram(gl, vs, fs)\r\n    gl.useProgram(shaderProgram)\r\n    const uCanvasSize = gl.getUniformLocation(shaderProgram, 'uCanvasSize')\r\n    gl.uniform2f(uCanvasSize, simpleGL._width, simpleGL._height)\r\n    simpleGL._rectGL = {\r\n      shaderProgram,\r\n      aPoint: new SimpleAttribBuffer(gl, shaderProgram, 'aPoint', 2, 4),\r\n      uColor: new SimpleUniform(gl, shaderProgram, 'uColor', 4),\r\n    }\r\n  }\r\n  constructor(simpleGL, x = 0, y = 0, w = 0, h = 0) {\r\n    super(simpleGL)\r\n    this._simpleGL = simpleGL\r\n    this._gl = simpleGL._gl\r\n    this.x = x\r\n    this.y = y\r\n    this.w = w\r\n    this.h = h\r\n    this.r = 0\r\n    this.g = 0\r\n    this.b = 0\r\n    this.a = 0\r\n  }\r\n  color(r, g, b, a) {\r\n    this.r = r\r\n    this.g = g\r\n    this.b = b\r\n    this.a = a\r\n    return this\r\n  }\r\n  pos(x, y) {\r\n    this.x = x\r\n    this.y = y\r\n    return this\r\n  }\r\n  size(w, h) {\r\n    this.w = w\r\n    this.h = h\r\n    return this\r\n  }\r\n  _draw(relX, relY, relAlpha) {\r\n    const gl = this._gl\r\n    const info = this._simpleGL._rectGL\r\n    gl.useProgram(info.shaderProgram)\r\n    this._prepareObject()\r\n    const aPoint = info.aPoint.getFloat32Array()\r\n    const {x, y, w, h, r, g, b, a} = this\r\n    aPoint[0] = relX + x\r\n    aPoint[1] = relY + y\r\n    aPoint[2] = relX + x\r\n    aPoint[3] = relY + y + h\r\n    aPoint[4] = relX + x + w\r\n    aPoint[5] = relY + y + h\r\n    aPoint[6] = relX + x + w\r\n    aPoint[7] = relY + y\r\n    info.aPoint.write()\r\n    info.uColor.set(r, g, b, a * this.alpha * relAlpha)\r\n    gl.drawArrays(gl.TRIANGLE_FAN, 0, 4)\r\n  }\r\n  _handleEvent(pos, name, detail) {\r\n    if (pos.x < this.x) return\r\n    if (pos.x >= this.x + this.w) return\r\n    if (pos.y < this.y) return\r\n    if (pos.y >= this.y + this.h) return\r\n    this._triggerBinding(name, detail)\r\n  }\r\n}\r\n\r\nclass SimpleContainer extends SimpleGLObject {\r\n  constructor(simpleGL, x = 0, y = 0) {\r\n    super(simpleGL)\r\n    this._simpleGL = simpleGL\r\n    this._gl = simpleGL._gl\r\n    this.x = x\r\n    this.y = y\r\n    this._children = []\r\n  }\r\n  pos(x, y) {\r\n    this.x = x\r\n    this.y = y\r\n    return this\r\n  }\r\n  blendMode(s, d, c) {\r\n    this._children.forEach((item) => {\r\n      item.blendMode(s, d, c)\r\n    })\r\n    return this\r\n  }\r\n  forEachChild(func) {\r\n    return this._children.forEach(func)\r\n  }\r\n  index(i) {\r\n    return this._children[i]\r\n  }\r\n  append(child) {\r\n    this._children.push(child)\r\n    return this\r\n  }\r\n  prepend(child) {\r\n    this._children.unshift(child)\r\n    return this\r\n  }\r\n  insert(child, before) {\r\n    const index = this._children.indexOf(before)\r\n    if (index >= 0) this._children.splice(index, 0, child)\r\n    return this\r\n  }\r\n  remove(child) {\r\n    const index = this._children.indexOf(child)\r\n    if (index >= 0) this._children.splice(index, 1)\r\n    return this\r\n  }\r\n  clear() {\r\n    while(this._children.length) this._children.shift()\r\n    return this\r\n  }\r\n  _draw(relX, relY, relAlpha) {\r\n    this._prepareObject()\r\n    this._children.forEach((node) => {\r\n      node._draw(relX + this.x, relY + this.y, this.alpha * relAlpha)\r\n    })\r\n  }\r\n  _handleEvent(pos, name, detail) {\r\n    this._children.forEach((node) => {\r\n      node._handleEvent({\r\n        x: pos.x - this.x,\r\n        y: pos.y - this.y\r\n      }, name, detail)\r\n    })\r\n  }\r\n}\r\n\r\nexport class SimpleGL {\r\n  constructor(canvas) {\r\n    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl')\r\n    gl.enable(gl.BLEND)\r\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA)\r\n    gl.viewport(0, 0, canvas.width, canvas.height)\r\n    gl.clearColor(0.0, 0.0, 0.0, 0.0)\r\n    gl.clearDepth(1)\r\n    this._canvas = canvas\r\n    this._gl = gl\r\n    this._width = canvas.width\r\n    this._height = canvas.height\r\n    this._rootContainer = new SimpleContainer(this, 0, 0)\r\n    SimpleRect._init(this)\r\n    this.setAutoUpdate(true)\r\n  }\r\n  setAutoUpdate(status) {\r\n    this._autoUpdate = status\r\n    if (status) {\r\n      const checkUpdate = () => {\r\n        this._scheduledChecking = false\r\n        if (!this._autoUpdate) return\r\n        requestAnimationFrame(checkUpdate)\r\n        this._scheduledChecking = true\r\n        this.update()\r\n      }\r\n      if (!this._scheduledChecking) {\r\n        requestAnimationFrame(checkUpdate)\r\n        this._scheduledChecking = true\r\n      }\r\n    }\r\n  }\r\n  update() {\r\n    const gl = this._gl\r\n    gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT)\r\n    this._rootContainer._draw(0, 0, 1)\r\n  }\r\n  getRootContainer() {\r\n    return this._rootContainer\r\n  }\r\n  createContainer(...args) {\r\n    return new SimpleContainer(this, ...args)\r\n  }\r\n  createRect(...args) {\r\n    return new SimpleRect(this, ...args)\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/simple-gl/index.js","module.exports = \"attribute vec2 aPoint;\\r\\nuniform vec2 uCanvasSize;\\r\\n\\r\\nvoid main(void) {\\r\\n  gl_Position = vec4(aPoint * mat2( 2.0/uCanvasSize.x,0, 0,-2.0/uCanvasSize.y ) + vec2(-1, 1), 0, 1);\\r\\n}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/simple-gl/rect.v.glsl\n// module id = 6\n// module chunks = 0","module.exports = \"uniform highp vec4 uColor;\\r\\n\\r\\nvoid main(void) {\\r\\n  gl_FragColor = uColor;\\r\\n}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/simple-gl/rect.f.glsl\n// module id = 7\n// module chunks = 0","import {\r\n  COLOR_R_ARR,\r\n  COLOR_G_ARR,\r\n  COLOR_B_ARR,\r\n  COLOR_BG_ARR,\r\n  R,\r\n  G,\r\n  B,\r\n  MAP_LETTER_NUM_MAP,\r\n} from './consts'\r\nimport {\r\n  createButton,\r\n  activateButton,\r\n  deactivateButton,\r\n  flashButton,\r\n  unflashButton,\r\n} from './buttons'\r\nimport { createTexts } from './texts'\r\nimport { animateObj } from './animate'\r\nimport { shareLevel } from './share'\r\n\r\nconst M_N_MAX = 5\r\nconst TILE_SIZE = 150\r\nconst TILE_MARGIN = 50\r\nconst TILE_AREA_MARGIN = (1080 - TILE_SIZE * M_N_MAX - TILE_MARGIN * (M_N_MAX - 1)) / 2\r\nconst ANIMATION_LENGTH = 200\r\n\r\nconst toPixelPos = (m, n, alpha) => {\r\n  const tileBetween = TILE_SIZE + TILE_MARGIN\r\n  return {\r\n    x: m * tileBetween,\r\n    y: n * tileBetween,\r\n    alpha: alpha\r\n  }\r\n}\r\n\r\nconst parseLevelStr = (str) => {\r\n  const signs = str.match(/[-rgbycpw]/g)\r\n  const map = []\r\n  for(let j = 0; j < M_N_MAX; j++) {\r\n    const line = []\r\n    for(let i = 0; i < M_N_MAX; i++) {\r\n      line.push(MAP_LETTER_NUM_MAP[signs.shift()])\r\n    }\r\n    map.push(line)\r\n  }\r\n  return map\r\n}\r\n\r\n/* eslint-disable no-use-before-define */\r\n\r\nexport default function(stage, mainContainer) {\r\n  // game states\r\n  let userClickEnabled = false\r\n  let userColor = R | G | B\r\n  let map = null\r\n  let originalMapJSON = null\r\n  let seed = 0\r\n  let levelNum = 0\r\n  let steps = []\r\n  let startTime = 0\r\n  let stepCount = 0\r\n  let timeTobj = null\r\n  let currentTutorialStep = null\r\n  let tutorialSteps = null\r\n  let levelEndCb = null\r\n\r\n  // base containers\r\n  const tilesContainer = stage.createContainer()\r\n  mainContainer.append(tilesContainer)\r\n  tilesContainer.pos(1920 - 1080 + TILE_AREA_MARGIN, TILE_AREA_MARGIN)\r\n  const bgContainer = stage.createContainer()\r\n  const fgContainer = stage.createContainer()\r\n  const animateContainer = stage.createContainer()\r\n  const tutorialContainer = stage.createContainer()\r\n  tilesContainer.append(tutorialContainer).append(bgContainer).append(fgContainer).append(animateContainer)\r\n\r\n  // meta containers\r\n  const metaContainer = stage.createContainer()\r\n  mainContainer.append(metaContainer)\r\n  metaContainer.pos(TILE_AREA_MARGIN, TILE_AREA_MARGIN)\r\n  const colorHintContainer = stage.createContainer(0, 1080 - TILE_AREA_MARGIN * 2 - 200)\r\n  const levelInfoContainer = stage.createContainer(0, 40)\r\n  const menuContainer = stage.createContainer(1080 - TILE_AREA_MARGIN, 30)\r\n  const userColorSelectContainer = stage.createContainer(0, 1080 - TILE_AREA_MARGIN * 2)\r\n  metaContainer.append(colorHintContainer).append(levelInfoContainer).append(userColorSelectContainer).append(menuContainer)\r\n\r\n  // add background tiles\r\n  const drawBackground = () => {\r\n    for(let j = 0; j < M_N_MAX; j++) {\r\n      // eslint-disable-next-line no-loop-func\r\n      for(let i = 0; i < M_N_MAX; i++) ((i, j) => {\r\n        const {x, y} = toPixelPos(i, j)\r\n        const tile = stage.createRect(x, y, TILE_SIZE, TILE_SIZE).color(...COLOR_BG_ARR)\r\n        bgContainer.append(tile)\r\n        tile.bind('click', () => {\r\n          handleUserClick(i, j)\r\n        })\r\n      })(i, j)\r\n    }\r\n  }\r\n  drawBackground()\r\n\r\n  // draw foreground tiles\r\n  const initTileContainers = () => {\r\n    for(let j = 0; j < M_N_MAX; j++) {\r\n      for(let i = 0; i < M_N_MAX; i++) {\r\n        const {x, y} = toPixelPos(i, j)\r\n        const singleTileContainer = stage.createContainer(x, y)\r\n        fgContainer.append(singleTileContainer)\r\n      }\r\n    }\r\n  }\r\n  initTileContainers()\r\n  const refreshTiles = () => {\r\n    for(let j = 0; j < M_N_MAX; j++) {\r\n      for(let i = 0; i < M_N_MAX; i++) {\r\n        const num = map[j][i]\r\n        const singleTileContainer = fgContainer.index(j * M_N_MAX + i)\r\n        singleTileContainer.clear()\r\n        if (num & R) {\r\n          const rect = stage.createRect(0, 0, TILE_SIZE, TILE_SIZE).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n          rect.tileType = R\r\n          singleTileContainer.append(rect)\r\n        }\r\n        if (num & G) {\r\n          const rect = stage.createRect(0, 0, TILE_SIZE, TILE_SIZE).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n          rect.tileType = G\r\n          singleTileContainer.append(rect)\r\n        }\r\n        if (num & B) {\r\n          const rect = stage.createRect(0, 0, TILE_SIZE, TILE_SIZE).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n          rect.tileType = B\r\n          singleTileContainer.append(rect)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // show user color status\r\n  let colorSelectButtons = []\r\n  let colorHints = {}\r\n  let stepCounterContainer = null\r\n  const resetMetaContainer = () => {\r\n    colorSelectButtons = []\r\n    colorHintContainer.clear()\r\n    levelInfoContainer.clear()\r\n    userColorSelectContainer.clear()\r\n  }\r\n  const TITLE_SIZE = 100\r\n  const TIME_SIZE = 40\r\n  const TITLE_COLOR_ARR = [0.5, 0.5, 0.5, 1]\r\n  const showTitle = (titleText, maxColor) => {\r\n    const titleContainer = createTexts(stage, titleText, TITLE_SIZE, TITLE_COLOR_ARR)\r\n    const timeContainer = stage.createContainer(0, TITLE_SIZE + 20)\r\n    stepCounterContainer = stage.createContainer(0, TITLE_SIZE + 20)\r\n    levelInfoContainer.append(titleContainer).append(timeContainer).append(stepCounterContainer)\r\n    const showTime = () => {\r\n      const timeDiff = Math.floor((Date.now() - startTime) / 1000)\r\n      const minuteStr = (timeDiff < 600 ? '0' : '') + Math.floor(timeDiff / 60)\r\n      const secondStr = ':' + String(timeDiff % 60 + 100).slice(1)\r\n      const str = minuteStr + secondStr\r\n      timeContainer.clear()\r\n      timeContainer.append(createTexts(stage, str, TIME_SIZE, TITLE_COLOR_ARR))\r\n      stepCounterContainer.pos((str.length + 1) * TIME_SIZE * 0.75, TITLE_SIZE + 20)\r\n    }\r\n    showTime()\r\n    timeTobj = setInterval(showTime, 1000)\r\n  }\r\n  const updateStepCounter = (num) => {\r\n    stepCounterContainer.clear()\r\n    stepCounterContainer.append(createTexts(stage, '(' + String(num) + ')', TIME_SIZE, TITLE_COLOR_ARR))\r\n  }\r\n  const showMenuButtons = () => {\r\n    const shareButton = createButton(stage, 90, 90, 10, () => {\r\n      shareLevel({seed, levelNum, timeUsed: Date.now() - startTime, stepCount})\r\n    }).pos(-440, 0)\r\n    const shareText = createTexts(stage, '\\x04', 90, [0.4, 0.4, 0.4, 1]).pos(-435, 5)\r\n    const resetButton = createButton(stage, 90, 90, 10, () => {\r\n      if (!userClickEnabled) return\r\n      if (currentTutorialStep) return\r\n      resetLevel()\r\n    }).pos(-300, 0)\r\n    const resetText = createTexts(stage, '\\x02', 90, [0.4, 0.4, 0.4, 1]).pos(-295, 5)\r\n    const quitButton = createButton(stage, 90, 90, 10, () => {\r\n      if (!userClickEnabled) return\r\n      if (currentTutorialStep) return\r\n      endLevel(true)\r\n    }).pos(-160, 0)\r\n    const quitText = createTexts(stage, '\\x03', 90, [0.4, 0.4, 0.4, 1]).pos(-155, 5)\r\n    menuContainer.clear().append(shareButton).append(shareText).append(resetButton).append(resetText).append(quitButton).append(quitText)\r\n  }\r\n  const showMapInfo = (str) => {\r\n    const mapInfoContainer = createTexts(stage, str, 30, [0.3, 0.3, 0.3, 1]).pos(0, -60)\r\n    levelInfoContainer.append(mapInfoContainer)\r\n  }\r\n  const refreshColorSelectButtons = () => {\r\n    colorSelectButtons.forEach((btn) => {\r\n      if (userColor === btn.userColor) activateButton(btn)\r\n      else deactivateButton(btn)\r\n    })\r\n    colorHintContainer.clear()\r\n    if (colorHints[userColor]) colorHintContainer.append(colorHints[userColor])\r\n  }\r\n  const drawColorHint = (maxColor) => {\r\n    const SIZE = 60\r\n    const INTERVAL = 2.25 * 60\r\n    const INITIAL_X = 22.5\r\n    let y = 0\r\n    ;[R|G, R|B, G|B, R|G|B].forEach((c) => {\r\n      if (maxColor & c) {\r\n        const rowOffset = -10\r\n        const container = stage.createContainer(rowOffset, 0)\r\n        const text = createTexts(stage, c === (R|G|B) ? '  +  +  =' : '  +  =', SIZE, [0.5, 0.5, 0.5, 1])\r\n        container.append(text.pos(0, y))\r\n        let x = INITIAL_X\r\n        let endX = INITIAL_X + INTERVAL * (c === (R|G|B) ? 3 : 2)\r\n        if (c & R) {\r\n          container.append(stage.createRect(x, y, SIZE, SIZE).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          container.append(stage.createRect(endX, y, SIZE, SIZE).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          x += INTERVAL\r\n        }\r\n        if (c & G) {\r\n          container.append(stage.createRect(x, y, SIZE, SIZE).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          container.append(stage.createRect(endX, y, SIZE, SIZE).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          x += INTERVAL\r\n        }\r\n        if (c & B) {\r\n          container.append(stage.createRect(x, y, SIZE, SIZE).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          container.append(stage.createRect(endX, y, SIZE, SIZE).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          x += INTERVAL\r\n        }\r\n        colorHints[c] = container\r\n      }\r\n    })\r\n  }\r\n  const drawUserColorSelect = (maxColor) => {\r\n    const SPACING = 30\r\n    const BORDER_SIZE = 15\r\n    const SIZE = 70\r\n    let x = 0\r\n    let y = -BORDER_SIZE * 2 - SIZE\r\n    const btns = colorSelectButtons = []\r\n    // eslint-disable-next-line no-loop-func\r\n    ;[R, G, B, R|G, R|B, G|B, R|G|B].forEach((c, index) => {\r\n      if ((maxColor & c) === c) {\r\n        const btn = createButton(stage, SIZE, SIZE, BORDER_SIZE, () => {\r\n          if (currentTutorialStep && (currentTutorialStep[0] !== -1 || currentTutorialStep[1] !== index)) return\r\n          userColor = c\r\n          refreshColorSelectButtons()\r\n          acceptUserClick()\r\n        }).pos(x + BORDER_SIZE, y + BORDER_SIZE)\r\n        btn.userColor = c\r\n        btns.push(btn)\r\n        userColorSelectContainer.append(btn)\r\n        if (c & R) userColorSelectContainer.append(stage.createRect(x + BORDER_SIZE, y + BORDER_SIZE, SIZE, SIZE).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n        if (c & G) userColorSelectContainer.append(stage.createRect(x + BORDER_SIZE, y + BORDER_SIZE, SIZE, SIZE).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n        if (c & B) userColorSelectContainer.append(stage.createRect(x + BORDER_SIZE, y + BORDER_SIZE, SIZE, SIZE).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n        x += BORDER_SIZE * 2 + SIZE + SPACING\r\n      }\r\n    })\r\n  }\r\n\r\n  // controllers\r\n  const findTileRectByColor = (singleTileContainer, color) => {\r\n    let rect = null\r\n    singleTileContainer.forEachChild((item) => {\r\n      if (item.tileType === color) {\r\n        rect = item\r\n        return false\r\n      }\r\n    })\r\n    return rect\r\n  }\r\n  const cloneRect = (rect) => {\r\n    const ret = stage.createRect(rect.x, rect.y, rect.w, rect.h).color(rect.r, rect.g, rect.b, rect.a).blendMode('SRC_ALPHA', 'ONE')\r\n    ret.tileType = rect.tileType\r\n    return ret\r\n  }\r\n  const checkColorToAdj = (m, n, toM, toN, color, srcRect) => {\r\n    if (toM < 0 || toM >= M_N_MAX || toN < 0 || toN >= M_N_MAX) return\r\n    // prepare rect\r\n    const rect = cloneRect(srcRect)\r\n    const srcPos = toPixelPos(m, n, 1)\r\n    const toPos = toPixelPos(toM, toN, 1)\r\n    const midPos = {\r\n      x: (srcPos.x + toPos.x) / 2,\r\n      y: (srcPos.y + toPos.y) / 2,\r\n      alpha: 0\r\n    }\r\n    animateContainer.append(rect)\r\n    const num = map[toN][toM]\r\n    map[toN][toM] ^= color\r\n    if (num & color) {\r\n      // erase\r\n      const singleTileContainer = fgContainer.index(toN * M_N_MAX + toM)\r\n      const oldRect = findTileRectByColor(singleTileContainer, color)\r\n      singleTileContainer.remove(oldRect)\r\n      rect.pos(toPos.x, toPos.y).setAlpha(1)\r\n      animateObj(rect, midPos, ANIMATION_LENGTH)\r\n    } else {\r\n      // add\r\n      rect.pos(midPos.x, midPos.y).setAlpha(0)\r\n      animateObj(rect, toPos, ANIMATION_LENGTH)\r\n    }\r\n  }\r\n  const eraseColor = (m, n, color) => {\r\n    userClickEnabled = false\r\n    map[n][m] ^= color\r\n    // find rect\r\n    const singleTileContainer = fgContainer.index(n * M_N_MAX + m)\r\n    const rect = findTileRectByColor(singleTileContainer, color)\r\n    // handling adjs\r\n    checkColorToAdj(m, n, m - 1, n, color, rect)\r\n    checkColorToAdj(m, n, m + 1, n, color, rect)\r\n    checkColorToAdj(m, n, m, n - 1, color, rect)\r\n    checkColorToAdj(m, n, m, n + 1, color, rect)\r\n    // animate self\r\n    const toPos = {\r\n      x: 0,\r\n      y: 0,\r\n      alpha: 0,\r\n    }\r\n    animateObj(rect, toPos, ANIMATION_LENGTH, () => {\r\n      requestAnimationFrame(() => {\r\n        animateContainer.clear()\r\n        refreshTiles()\r\n        acceptUserClick()\r\n        if (checkLevelEnd()) return\r\n      })\r\n    })\r\n  }\r\n  const addColor = (m, n, color) => {\r\n    userClickEnabled = false\r\n    map[n][m] ^= color\r\n    // create rect\r\n    const singleTileContainer = fgContainer.index(n * M_N_MAX + m)\r\n    const colorArr = {\r\n      [R]: COLOR_R_ARR,\r\n      [G]: COLOR_G_ARR,\r\n      [B]: COLOR_B_ARR,\r\n    }[color]\r\n    const rect = stage.createRect(0, 0, TILE_SIZE, TILE_SIZE).color(...colorArr).blendMode('SRC_ALPHA', 'ONE')\r\n    rect.setAlpha(0)\r\n    singleTileContainer.append(rect)\r\n    // handling adjs\r\n    checkColorToAdj(m, n, m - 1, n, color, rect)\r\n    checkColorToAdj(m, n, m + 1, n, color, rect)\r\n    checkColorToAdj(m, n, m, n - 1, color, rect)\r\n    checkColorToAdj(m, n, m, n + 1, color, rect)\r\n    // animate self\r\n    const toPos = {\r\n      x: 0,\r\n      y: 0,\r\n      alpha: 1,\r\n    }\r\n    animateObj(rect, toPos, ANIMATION_LENGTH, () => {\r\n      requestAnimationFrame(() => {\r\n        animateContainer.clear()\r\n        refreshTiles()\r\n        acceptUserClick()\r\n        if (checkLevelEnd()) return\r\n      })\r\n    })\r\n  }\r\n\r\n  // user click handler\r\n  const handleUserClick = (m, n) => {\r\n    if (!userClickEnabled) return\r\n    if (currentTutorialStep && (currentTutorialStep[0] !== m || currentTutorialStep[1] !== n)) return\r\n    const num = map[n][m]\r\n    steps.push({\r\n      m,\r\n      n,\r\n      from: num,\r\n      to: num ? 0 : userColor\r\n    })\r\n    updateStepCounter(++stepCount)\r\n    if (num) {\r\n      userColor = num\r\n      refreshColorSelectButtons()\r\n      if (num & R) eraseColor(m, n, R)\r\n      if (num & G) eraseColor(m, n, G)\r\n      if (num & B) eraseColor(m, n, B)\r\n    } else {\r\n      if (userColor & R) addColor(m, n, R)\r\n      if (userColor & G) addColor(m, n, G)\r\n      if (userColor & B) addColor(m, n, B)\r\n    }\r\n  }\r\n  const acceptUserClick = () => {\r\n    userClickEnabled = true\r\n    if (currentTutorialStep) {\r\n      if (currentTutorialStep[0] === -1) {\r\n        const btn = colorSelectButtons[currentTutorialStep[1]]\r\n        unflashButton(btn)\r\n        activateButton(btn)\r\n      } else {\r\n        tutorialContainer.clear()\r\n      }\r\n    }\r\n    currentTutorialStep = tutorialSteps.shift()\r\n    if (currentTutorialStep) {\r\n      if (currentTutorialStep[0] === -1) {\r\n        const btn = colorSelectButtons[currentTutorialStep[1]]\r\n        flashButton(btn)\r\n      } else {\r\n        const pos = toPixelPos(currentTutorialStep[0], currentTutorialStep[1])\r\n        const btn = createButton(stage, TILE_SIZE, TILE_SIZE, 20, () => {\r\n          unflashButton(btn)\r\n          activateButton(btn)\r\n        }).pos(pos.x, pos.y)\r\n        tutorialContainer.append(btn)\r\n        flashButton(btn)\r\n      }\r\n    }\r\n  }\r\n\r\n  // load map and start\r\n  const loadLevel = (level, cb) => {\r\n    // load level data\r\n    levelEndCb = cb\r\n    tutorialSteps = level.tutorialSteps || []\r\n    currentTutorialStep = null\r\n    map = level.map || parseLevelStr(level.mapStr)\r\n    originalMapJSON = JSON.stringify(map)\r\n    levelNum = level.level\r\n    seed = level.seed\r\n    // reset ui\r\n    animateContainer.clear()\r\n    tutorialContainer.clear()\r\n    resetMetaContainer()\r\n    refreshTiles()\r\n    // stat used colors\r\n    let hasR = false\r\n    let hasG = false\r\n    let hasB = false\r\n    for(let j = 0; j < M_N_MAX; j++) {\r\n      for(let i = 0; i < M_N_MAX; i++) {\r\n        const num = map[j][i]\r\n        if (num & R) hasR = true\r\n        if (num & G) hasG = true\r\n        if (num & B) hasB = true\r\n      }\r\n    }\r\n    const maxColor = (hasR ? R : 0) | (hasG ? G : 0) | (hasB ? B : 0)\r\n    userColor = MAP_LETTER_NUM_MAP[level.userColor] || maxColor\r\n    if (maxColor !== R && maxColor !== G && maxColor !== B) {\r\n      drawColorHint(maxColor)\r\n      drawUserColorSelect(maxColor)\r\n      refreshColorSelectButtons()\r\n    }\r\n    // show title\r\n    startTime = Date.now() - (level.timeUsed || 0)\r\n    showTitle(level.title, maxColor)\r\n    updateStepCounter(stepCount = level.stepCount || 0)\r\n    showMenuButtons()\r\n    if (level.difficulty) showMapInfo('SEED:' + level.seed + ' D:' + level.difficulty)\r\n    acceptUserClick()\r\n  }\r\n  const resetLevel = () => {\r\n    map = JSON.parse(originalMapJSON)\r\n    refreshTiles()\r\n  }\r\n  const checkLevelEnd = () => {\r\n    let status = -1\r\n    for(let j = 0; j < M_N_MAX; j++) {\r\n      for(let i = 0; i < M_N_MAX; i++) {\r\n        const num = map[j][i]\r\n        if (status < 0) status = num\r\n        else if (status !== num) return false\r\n      }\r\n    }\r\n    endLevel()\r\n    return true\r\n  }\r\n  const endLevel = (quit = false) => {\r\n    clearInterval(timeTobj)\r\n    levelEndCb({\r\n      timeUsed: Date.now() - startTime,\r\n      stepCount,\r\n      quit\r\n    })\r\n  }\r\n\r\n  return {\r\n    loadLevel,\r\n    changeOrientation: (isVertical) => {\r\n      if (isVertical) {\r\n        tilesContainer.pos(TILE_AREA_MARGIN, (1920 - 1080) / 2 + TILE_AREA_MARGIN)\r\n        colorHintContainer.pos(0, 1920 - TILE_AREA_MARGIN * 2 - 200)\r\n        userColorSelectContainer.pos(0, 1920 - TILE_AREA_MARGIN * 2)\r\n      }\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/tiles.js","export default {\r\n  A: `\r\n    [6,8]\r\n       +\r\n      + +\r\n     +   +\r\n     +   +\r\n     +++++\r\n     +   +\r\n     +   +\r\n  `,\r\n  B: `\r\n    [6,8]\r\n     ++++\r\n     +   +\r\n     +   +\r\n     ++++\r\n     +   +\r\n     +   +\r\n     ++++\r\n  `,\r\n  C: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +\r\n     +\r\n     +\r\n     +   +\r\n      +++\r\n  `,\r\n  D: `\r\n    [6,8]\r\n     +++\r\n     +  +\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +  +\r\n     +++\r\n  `,\r\n  E: `\r\n    [6,8]\r\n     +++++\r\n     +\r\n     +\r\n     ++++\r\n     +\r\n     +\r\n     +++++\r\n  `,\r\n  F: `\r\n    [6,8]\r\n     +++++\r\n     +\r\n     +\r\n     ++++\r\n     +\r\n     +\r\n     +\r\n  `,\r\n  G: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +\r\n     +  ++\r\n     +   +\r\n     +  ++\r\n      ++ +\r\n  `,\r\n\r\n  H: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +++++\r\n     +   +\r\n     +   +\r\n     +   +\r\n  `,\r\n  I: `\r\n    [6,8]\r\n      +++\r\n       +\r\n       +\r\n       +\r\n       +\r\n       +\r\n      +++\r\n  `,\r\n  J: `\r\n    [6,8]\r\n      +++\r\n       +\r\n       +\r\n       +\r\n       +\r\n     + +\r\n      +\r\n  `,\r\n  K: `\r\n    [6,8]\r\n     +   +\r\n     +  +\r\n     + +\r\n     ++\r\n     + +\r\n     +  +\r\n     +   +\r\n  `,\r\n  L: `\r\n    [6,8]\r\n      +\r\n      +\r\n      +\r\n      +\r\n      +\r\n      +\r\n      ++++\r\n  `,\r\n  M: `\r\n    [6,8]\r\n     +   +\r\n     ++ ++\r\n     + + +\r\n     + + +\r\n     +   +\r\n     +   +\r\n     +   +\r\n  `,\r\n  N: `\r\n    [6,8]\r\n     +   +\r\n     ++  +\r\n     + + +\r\n     +  ++\r\n     +   +\r\n     +   +\r\n     +   +\r\n  `,\r\n\r\n  O: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n      +++\r\n  `,\r\n  P: `\r\n    [6,8]\r\n     +++\r\n     +  +\r\n     +   +\r\n     +  +\r\n     +++\r\n     +\r\n     +\r\n  `,\r\n  Q: `\r\n    [6,8]\r\n     +   +\r\n     ++  +\r\n     + + +\r\n     +  ++\r\n     +   +\r\n     +   +\r\n     +   +\r\n  `,\r\n  R: `\r\n    [6,8]\r\n     ++++\r\n     +   +\r\n     +   +\r\n     +  +\r\n     +++\r\n     +  +\r\n     +   +\r\n  `,\r\n  S: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n      +\r\n       +\r\n        +\r\n     +   +\r\n      +++\r\n  `,\r\n  T: `\r\n    [6,8]\r\n     +++++\r\n       +\r\n       +\r\n       +\r\n       +\r\n       +\r\n       +\r\n  `,\r\n\r\n  U: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +  ++\r\n      ++ +\r\n  `,\r\n  V: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n      + +\r\n       +\r\n  `,\r\n  W: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n     +   +\r\n     + + +\r\n     + + +\r\n     + + +\r\n      + +\r\n  `,\r\n  X: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n      + +\r\n       +\r\n      + +\r\n     +   +\r\n     +   +\r\n  `,\r\n  Y: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n      + +\r\n       +\r\n       +\r\n       +\r\n       +\r\n  `,\r\n  Z: `\r\n    [6,8]\r\n     +++++\r\n         +\r\n      + +\r\n       +\r\n      + +\r\n     +\r\n     +++++\r\n  `,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/dot-fonts/letters.js","export default {\r\n  0: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +  ++\r\n     + + +\r\n     ++  +\r\n     +   +\r\n      +++\r\n  `,\r\n  1: `\r\n    [6,8]\r\n       +\r\n      ++\r\n       +\r\n       +\r\n       +\r\n       +\r\n      +++\r\n  `,\r\n  2: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n        +\r\n       +\r\n      +\r\n     +\r\n     +++++\r\n  `,\r\n  3: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n         +\r\n       ++\r\n         +\r\n     +   +\r\n      +++\r\n  `,\r\n  4: `\r\n    [6,8]\r\n        +\r\n       ++\r\n      + +\r\n     +  +\r\n     +++++\r\n        +\r\n        +\r\n  `,\r\n  5: `\r\n    [6,8]\r\n     +++++\r\n     +\r\n     +\r\n      +++\r\n         +\r\n     +   +\r\n      +++\r\n  `,\r\n  6: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +\r\n     ++++\r\n     +   +\r\n     +   +\r\n      +++\r\n  `,\r\n  7: `\r\n    [6,8]\r\n     +++++\r\n         +\r\n        +\r\n       +\r\n      +\r\n      +\r\n      +\r\n  `,\r\n  8: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +   +\r\n      +++\r\n     +   +\r\n     +   +\r\n      +++\r\n  `,\r\n  9: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +   +\r\n      ++++\r\n         +\r\n     +   +\r\n      +++\r\n  `,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/dot-fonts/numbers.js","export default {\r\n  ' ': `\r\n    [6,8]\r\n  `,\r\n  '-': `\r\n    [6,8]\r\n\r\n\r\n\r\n     +++++\r\n\r\n\r\n\r\n  `,\r\n  '=': `\r\n    [6,8]\r\n\r\n\r\n     +++++\r\n\r\n     +++++\r\n\r\n\r\n  `,\r\n  '+': `\r\n    [6,8]\r\n\r\n       +\r\n       +\r\n     +++++\r\n       +\r\n       +\r\n\r\n  `,\r\n  '.': `\r\n    [6,8]\r\n\r\n\r\n\r\n\r\n\r\n      ++\r\n      ++\r\n  `,\r\n  ':': `\r\n    [6,8]\r\n\r\n\r\n       +\r\n\r\n\r\n       +\r\n\r\n  `,\r\n  '#': `\r\n    [6,8]\r\n      + +\r\n      + +\r\n     +++++\r\n      + +\r\n     +++++\r\n      + +\r\n      + +\r\n  `,\r\n  '?': `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n         +\r\n        +\r\n       +\r\n\r\n       +\r\n  `,\r\n  '(': `\r\n    [6,8]\r\n        +\r\n       +\r\n      +\r\n      +\r\n      +\r\n       +\r\n        +\r\n  `,\r\n  ')': `\r\n    [6,8]\r\n      +\r\n       +\r\n        +\r\n        +\r\n        +\r\n       +\r\n      +\r\n  `,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/dot-fonts/symbols.js","export default {\r\n  '\\x01': `\r\n    [6,8]\r\n     ++\r\n     +++\r\n     ++++\r\n     +++++\r\n     ++++\r\n     +++\r\n     ++\r\n  `,\r\n  '\\x02': `\r\n    [6,8]\r\n\r\n     +++++\r\n      +  +\r\n         +\r\n         +\r\n     +++++\r\n\r\n  `,\r\n  '\\x03': `\r\n    [6,8]\r\n\r\n     +   +\r\n      + +\r\n       +\r\n      + +\r\n     +   +\r\n\r\n  `,\r\n  '\\x04': `\r\n    [6,8]\r\n\r\n      ++++\r\n        ++\r\n       + +\r\n      +  +\r\n     +\r\n\r\n  `,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/dot-fonts/special.js","import {\r\n  COLOR_R_ARR,\r\n  COLOR_G_ARR,\r\n  COLOR_B_ARR,\r\n} from './consts'\r\nimport {\r\n  createButton,\r\n} from './buttons'\r\nimport { createTexts } from './texts'\r\n\r\nexport default (stage, container, options) => {\r\n  const {language} = options\r\n  let selectCb = null\r\n\r\n  const titleLineContainer = stage.createContainer().pos(12, 240)\r\n  let block1 = null\r\n  let block2 = null\r\n  let block3 = null\r\n  if (language === 'zh-CN') {\r\n    block1 = createTexts(stage, '三', 100, COLOR_R_ARR).pos(-30, -30).blendMode('SRC_ALPHA', 'ONE')\r\n    block2 = createTexts(stage, '原', 100, COLOR_G_ARR).pos(760 * 1 / 6 - 30, -30).blendMode('SRC_ALPHA', 'ONE')\r\n    block3 = createTexts(stage, '色', 100, COLOR_B_ARR).pos(760 * 2 / 6 - 30, -30).blendMode('SRC_ALPHA', 'ONE')\r\n  } else {\r\n    block1 = stage.createRect(0, 0, 40, 40).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n    block2 = stage.createRect(760 * 1 / 6, 0, 40, 40).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n    block3 = stage.createRect(760 * 2 / 6, 0, 40, 40).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  }\r\n  const block41 = stage.createRect(760 * 3 / 6, 0, 40, 40).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const block42 = stage.createRect(760 * 3 / 6, 0, 40, 40).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const block51 = stage.createRect(760 * 4 / 6, 0, 40, 40).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const block52 = stage.createRect(760 * 4 / 6, 0, 40, 40).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const block61 = stage.createRect(760 * 5 / 6, 0, 40, 40).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const block62 = stage.createRect(760 * 5 / 6, 0, 40, 40).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const block71 = stage.createRect(760, 0, 40, 40).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const block72 = stage.createRect(760, 0, 40, 40).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const block73 = stage.createRect(760, 0, 40, 40).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  titleLineContainer.append(block1).append(block2).append(block3)\r\n    .append(block41).append(block42)\r\n    .append(block51).append(block52)\r\n    .append(block61).append(block62)\r\n    .append(block71).append(block72).append(block73)\r\n\r\n  const titleContainer = stage.createContainer().pos(555, 300)\r\n  const title1 = createTexts(stage, 'TRI', 120, COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const title2 = createTexts(stage, 'TRI', 120, COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const title3 = createTexts(stage, 'COLORS', 120, COLOR_G_ARR).pos(270, 0).blendMode('SRC_ALPHA', 'ONE')\r\n  const title4 = createTexts(stage, 'COLORS', 120, COLOR_B_ARR).pos(270, 0).blendMode('SRC_ALPHA', 'ONE')\r\n  titleContainer.append(title1).append(title2).append(title3).append(title4).append(titleLineContainer)\r\n  container.append(titleContainer)\r\n\r\n\r\n  const tutorialContainer = stage.createContainer().pos(700, 600)\r\n  const tutorialButton = createButton(stage, 180, 180, 20, () => {\r\n    selectCb('tutorial')\r\n  }).pos(-20, -20)\r\n  const tutorialText1 = createTexts(stage, '?', 140, COLOR_R_ARR).pos(5, 10).blendMode('SRC_ALPHA', 'ONE')\r\n  const tutorialText2 = createTexts(stage, '?', 140, COLOR_G_ARR).pos(5, 10).blendMode('SRC_ALPHA', 'ONE')\r\n  tutorialContainer.append(tutorialButton).append(tutorialText1).append(tutorialText2)\r\n  container.append(tutorialContainer)\r\n\r\n  const endlessContainer = stage.createContainer().pos(1060, 600)\r\n  const endlessButton = createButton(stage, 180, 180, 20, () => {\r\n    selectCb('endless')\r\n  }).pos(-20, -20)\r\n  const endlessText1 = createTexts(stage, '\\x01', 140, COLOR_R_ARR).pos(5, 10).blendMode('SRC_ALPHA', 'ONE')\r\n  const endlessText2 = createTexts(stage, '\\x01', 140, COLOR_G_ARR).pos(5, 10).blendMode('SRC_ALPHA', 'ONE')\r\n  endlessContainer.append(endlessButton).append(endlessText1).append(endlessText2)\r\n  container.append(endlessContainer)\r\n\r\n  const authorContainer = stage.createContainer().pos(840, 960)\r\n  const authorText = createTexts(stage, 'LASTLEAF', 40, [0.4, 0.4, 0.4, 1])\r\n  const authorTextBg = stage.createRect(0, 0, 240, 40).color(0, 0, 0, 0).bind('click', () => {\r\n    selectCb('')\r\n  })\r\n  authorContainer.append(authorTextBg).append(authorText)\r\n  container.append(authorContainer)\r\n\r\n  return {\r\n    changeOrientation: (isVertical) => {\r\n      if (isVertical) {\r\n        titleContainer.pos(135, 500)\r\n        tutorialContainer.pos(260, 1200)\r\n        endlessContainer.pos(700, 1200)\r\n        authorContainer.pos(420, 1800)\r\n      }\r\n    },\r\n    onSelect: (cb) => {\r\n      selectCb = cb\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/cover.js","export default () => ({\r\n  tutorialSteps: [\r\n    [2, 2],\r\n    [2, 3],\r\n    [2, 1]\r\n  ],\r\n  title: '#01',\r\n  mapStr: `\r\n    --r--\r\n    -r-r-\r\n    -rrr-\r\n    -r-r-\r\n    --r--\r\n  `\r\n})\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/levels/tutorial-1.js","export default () => ({\r\n  tutorialSteps: [\r\n    [1, 2],\r\n    [3, 2],\r\n    [4, 1],\r\n    [0, 3],\r\n  ],\r\n  title: '#02',\r\n  mapStr: `\r\n    ----b\r\n    -r-pb\r\n    pr-rp\r\n    bp-r-\r\n    b----\r\n  `\r\n})\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/levels/tutorial-2.js","export default () => ({\r\n  tutorialSteps: [\r\n    [1, 3],\r\n    [3, 3],\r\n    [-1, 2],\r\n    [2, 1],\r\n    [2, 2]\r\n  ],\r\n  title: '#03',\r\n  mapStr: `\r\n    --b--\r\n    -b-b-\r\n    -c-p-\r\n    ggwrr\r\n    -g-r-\r\n  `\r\n})\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/levels/tutorial-3.js","import {\r\n  R,\r\n  G,\r\n  B,\r\n} from './consts'\r\n\r\nconst D_PER_LEVEL = 250\r\nconst D_COLOR_COUNT = [0, 3, 5, 7] // the multiplier for how many base colors used in the map\r\nconst D_STEP_BATCH = [0, 8, 5, 0, 3] // the multiplier for how many steps are in a batch (because of symmetry)\r\nconst D_STEP_SAME_POINT = [4, 3, 2] // the multiplier for how many colors has been set in this point\r\n\r\nconst P_SYMMETRY_NONE = 0\r\nconst P_SYMMETRY_H = 0.3\r\nconst P_SYMMETRY_V = 0.5\r\nconst P_SYMMETRY_ROTATE = 0.7\r\nconst P_SYMMETRY_ALL = 0.9\r\nconst P_SYMMETRY_ALL_ROTATE = 1\r\n\r\nconst P_SYMMETRY_NONE_INC = 0.02 / D_PER_LEVEL\r\nconst P_SYMMETRY_H_INC = 0.01 / D_PER_LEVEL\r\nconst P_SYMMETRY_V_INC = 0.005 / D_PER_LEVEL\r\nconst P_SYMMETRY_ROTATE_INC = 0.01 / D_PER_LEVEL\r\nconst P_SYMMETRY_ALL_INC = 0.001 / D_PER_LEVEL\r\nconst P_SYMMETRY_ALL_ROTATE_INC = 0\r\n\r\nconst SYMMETRY_INC_LEVELS = 16\r\nconst FAIL_STEP = 4\r\n\r\nconst P_2_COLOR_D_MIN = D_PER_LEVEL * 3\r\nconst P_3_COLOR_D_MIN = D_PER_LEVEL * 6\r\nconst P_2_COLOR_D_INC = 0.2 / D_PER_LEVEL\r\nconst P_3_COLOR_D_INC = 0.1 / D_PER_LEVEL\r\n\r\nconst SYMMETRY_NONE = 0\r\nconst SYMMETRY_H = 1\r\nconst SYMMETRY_V = 2\r\nconst SYMMETRY_ROTATE = 3\r\nconst SYMMETRY_ALL = 4\r\nconst SYMMETRY_ALL_ROTATE = 5\r\n\r\nconst levelToDifficulty = (level) => {\r\n  return level * D_PER_LEVEL\r\n}\r\n\r\nexport const endless = ({seed, level, timeUsed, stepCount}) => {\r\n  const difficulty = levelToDifficulty(level)\r\n\r\n  // random utils\r\n  let curSeed = seed + level * 4817\r\n  let curRandMul = 1\r\n  const getRandom = (max) => {\r\n    let prevRandMul = curRandMul\r\n    curRandMul *= max\r\n    if (curRandMul > 1000000000) {\r\n      curSeed = curSeed * 137 % 1000000000\r\n      prevRandMul = curRandMul = 1\r\n    }\r\n    return Math.floor(curSeed / prevRandMul) % max\r\n  }\r\n\r\n  // init map\r\n  const colorMap = []\r\n  for(let j = 0; j < 5; j++) {\r\n    const line = []\r\n    for(let i = 0; i < 5; i++) {\r\n      line.push(0)\r\n    }\r\n    colorMap.push(line)\r\n  }\r\n  const opCountMap = []\r\n  for(let j = 0; j < 5; j++) {\r\n    const line = []\r\n    for(let i = 0; i < 5; i++) {\r\n      line.push(0)\r\n    }\r\n    opCountMap.push(line)\r\n  }\r\n\r\n  // generate symmetry type\r\n  const symmetryRand = getRandom(10) / 10\r\n  let symmetryType = 0\r\n  const symmetryIncLevels = Math.min(level, SYMMETRY_INC_LEVELS)\r\n  if (symmetryRand < P_SYMMETRY_NONE + symmetryIncLevels * P_SYMMETRY_NONE_INC) {\r\n    symmetryType = SYMMETRY_NONE\r\n  } else if (symmetryRand < P_SYMMETRY_H + symmetryIncLevels * P_SYMMETRY_H_INC) {\r\n    symmetryType = SYMMETRY_H\r\n  } else if (symmetryRand < P_SYMMETRY_V + symmetryIncLevels * P_SYMMETRY_V_INC) {\r\n    symmetryType = SYMMETRY_V\r\n  } else if (symmetryRand < P_SYMMETRY_ROTATE + symmetryIncLevels * P_SYMMETRY_ROTATE_INC) {\r\n    symmetryType = SYMMETRY_ROTATE\r\n  } else if (symmetryRand < P_SYMMETRY_ALL + symmetryIncLevels * P_SYMMETRY_ALL_INC) {\r\n    symmetryType = SYMMETRY_ALL\r\n  } else if (symmetryRand < P_SYMMETRY_ALL_ROTATE + symmetryIncLevels * P_SYMMETRY_ALL_ROTATE_INC) {\r\n    symmetryType = SYMMETRY_ALL_ROTATE\r\n  }\r\n  if (level === 1) {\r\n    symmetryType = SYMMETRY_NONE\r\n  } else if (level === 2) {\r\n    if (symmetryType === SYMMETRY_ALL) symmetryType = SYMMETRY_H\r\n    else if (symmetryType === SYMMETRY_ALL_ROTATE) symmetryType = SYMMETRY_V\r\n  }\r\n\r\n  // generate color type\r\n  const colorKey = [R, G, B][getRandom(3)]\r\n  const colorRand = getRandom(10) / 10\r\n  let colors = [R, G, B]\r\n  let colorType = 1\r\n  const pColor2 = (difficulty - P_2_COLOR_D_MIN) * P_2_COLOR_D_INC\r\n  const pColor3 = (difficulty - P_3_COLOR_D_MIN) * P_3_COLOR_D_INC\r\n  if (colorRand < pColor3) {\r\n    colors = [R, G, B]\r\n    colorType = 3\r\n  } else if (colorRand < pColor2) {\r\n    colors.splice(colors.indexOf(colorKey), 1)\r\n    colorType = 2\r\n  } else {\r\n    colors = [colorKey]\r\n    colorType = 1\r\n  }\r\n\r\n  // generate each step\r\n  let currentD = 0\r\n  // eslint-disable-next-line complexity\r\n  const nextStep = () => {\r\n    const stepColor = colors[getRandom(colorType)]\r\n\r\n    // stat available positions\r\n    const availablePos = []\r\n    for(let j = 0; j < 5; j++) {\r\n      for(let i = 0; i < 5; i++) {\r\n        if (colorMap[j][i] & stepColor) continue\r\n        availablePos.push([i, j])\r\n      }\r\n    }\r\n    if (!availablePos.length) return 0\r\n    const [stepM, stepN] = availablePos[getRandom(availablePos.length)]\r\n    let stepSamePoint = 0\r\n    if (colorMap[stepN][stepM] & R) stepSamePoint++\r\n    if (colorMap[stepN][stepM] & G) stepSamePoint++\r\n    if (colorMap[stepN][stepM] & B) stepSamePoint++\r\n\r\n    // init maps\r\n    const signMap = []\r\n    for(let j = 0; j < 5; j++) {\r\n      const line = []\r\n      for(let i = 0; i < 5; i++) {\r\n        line.push(0)\r\n      }\r\n      signMap.push(line)\r\n    }\r\n    const weightMap = []\r\n    for(let j = 0; j < 5; j++) {\r\n      const line = []\r\n      for(let i = 0; i < 5; i++) {\r\n        line.push(0)\r\n      }\r\n      weightMap.push(line)\r\n    }\r\n\r\n    // construct sign map\r\n    let stepCount = 0\r\n    const setSignMap = (m, n) => {\r\n      if (signMap[n][m]) return\r\n      stepCount++\r\n      signMap[n][m] = 1\r\n    }\r\n    setSignMap(stepM, stepN)\r\n    if (symmetryType === SYMMETRY_H) {\r\n      setSignMap(4 - stepM, stepN)\r\n    } else if (symmetryType === SYMMETRY_V) {\r\n      setSignMap(stepM, 4 - stepN)\r\n    } else if (symmetryType === SYMMETRY_ROTATE) {\r\n      setSignMap(4 - stepM, 4 - stepN)\r\n    } else if (symmetryType === SYMMETRY_ALL) {\r\n      setSignMap(4 - stepM, stepN)\r\n      setSignMap(stepM, 4 - stepN)\r\n      setSignMap(4 - stepM, 4 - stepN)\r\n    } else if (symmetryType === SYMMETRY_ALL_ROTATE) {\r\n      setSignMap(4 - stepN, stepM)\r\n      setSignMap(stepN, 4 - stepM)\r\n      setSignMap(4 - stepM, 4 - stepN)\r\n    }\r\n\r\n    // extend weight map\r\n    let stepD = 0\r\n    for(let j = 0; j < 5; j++) {\r\n      for(let i = 0; i < 5; i++) {\r\n        if (signMap[j - 1] && signMap[j - 1][i]) stepD += (++weightMap[j][i]) + opCountMap[j][i]\r\n        if (signMap[j + 1] && signMap[j + 1][i]) stepD += (++weightMap[j][i]) + opCountMap[j][i]\r\n        if (signMap[j][i - 1]) stepD += (++weightMap[j][i]) + opCountMap[j][i]\r\n        if (signMap[j][i + 1]) stepD += (++weightMap[j][i]) + opCountMap[j][i]\r\n        if (signMap[j][i]) stepD += (++weightMap[j][i]) + opCountMap[j][i]\r\n      }\r\n    }\r\n\r\n    // check and write to map\r\n    stepD *= D_COLOR_COUNT[colorType] * D_STEP_BATCH[stepCount] * D_STEP_SAME_POINT[stepSamePoint]\r\n    if (stepD + currentD <= difficulty || currentD === 0) {\r\n      for(let j = 0; j < 5; j++) {\r\n        for(let i = 0; i < 5; i++) {\r\n          if (weightMap[j][i] % 2) {\r\n            colorMap[j][i] ^= stepColor\r\n          }\r\n          opCountMap[j][i] += weightMap[j][i]\r\n        }\r\n      }\r\n    } else {\r\n      stepD = 0\r\n    }\r\n    return stepD\r\n  }\r\n  let allowFailStep = FAIL_STEP\r\n  while (currentD < difficulty) {\r\n    const stepD = nextStep()\r\n    if (!stepD && !--allowFailStep) break\r\n    currentD += stepD\r\n  }\r\n\r\n  const levelObj = {\r\n    timeUsed,\r\n    stepCount,\r\n    title: '#' + (level < 10 ? '0' + level : level),\r\n    seed,\r\n    level,\r\n    difficulty: currentD,\r\n    map: colorMap\r\n  }\r\n  return levelObj\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/generator.js","export default {\r\n  \"三\": `\r\n    [12,12]\r\n\r\n       +++++++\r\n\r\n\r\n\r\n        +++++\r\n\r\n\r\n\r\n      +++++++++\r\n\r\n\r\n  `,\r\n  \"原\": `\r\n    [12,12]\r\n      ++++++++\r\n      +   +\r\n      + +++++\r\n      + +   +\r\n      + +++++\r\n      + +   +\r\n      + +++++\r\n      +   +\r\n     +  + + +\r\n     + +  +  +\r\n    +    ++\r\n\r\n  `,\r\n  \"色\": `\r\n    [12,12]\r\n       +\r\n      +++++\r\n     +   +\r\n    +   +\r\n     +++++++\r\n     +  +  +\r\n     +  +  +\r\n     +++++++\r\n     +\r\n     +     +\r\n      ++++++\r\n\r\n  `,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/dot-fonts/chinese.js","const SHARE_STR_VERSION = 0x1001\r\n\r\nconst toHexStr = (num, bytes) => {\r\n  let ret = num.toString(16)\r\n  while (ret.length < bytes) ret = '0' + ret\r\n  return ret\r\n}\r\n\r\nconst createShareStr = ({seed, levelNum, timeUsed, stepCount}) => {\r\n  const salt = Math.floor(Math.random() * (1 << 30))\r\n  const slices = [\r\n    toHexStr((salt + seed + levelNum + timeUsed + stepCount) ^ SHARE_STR_VERSION),\r\n    toHexStr((salt + seed + timeUsed) ^ stepCount, 8),\r\n    toHexStr(salt, 8),\r\n    toHexStr((salt + seed) ^ timeUsed, 8),\r\n    toHexStr((salt + seed + stepCount) ^ levelNum, 8),\r\n    toHexStr(salt ^ seed, 8),\r\n  ]\r\n  return SHARE_STR_VERSION + 'x' + slices.join('')\r\n}\r\n\r\nconst parseShareStr = (str) => {\r\n  const [version, slices] = str.split('x', 2)\r\n  if (parseInt(version, 10) !== SHARE_STR_VERSION) return null\r\n  const arr = slices.match(/[0-9a-z]{8}/ig)\r\n  const salt = parseInt(arr[2], 16)\r\n  const seed = parseInt(arr[5], 16) ^ salt\r\n  const timeUsed = parseInt(arr[3], 16) ^ (salt + seed)\r\n  const stepCount = parseInt(arr[1], 16) ^ (salt + seed + timeUsed)\r\n  const levelNum = parseInt(arr[4], 16) ^ (salt + seed + stepCount)\r\n  const examing = parseInt(arr[0], 16) ^ (salt + seed + levelNum + timeUsed + stepCount)\r\n  if (examing !== SHARE_STR_VERSION) return null\r\n  return {\r\n    seed,\r\n    levelNum,\r\n    timeUsed,\r\n    stepCount\r\n  }\r\n}\r\n\r\nexport const shareLevel = (info) => {\r\n  const str = createShareStr(info)\r\n  window.open(location.protocol + '//' + location.host + location.pathname + location.search + '#' + str, '_blank')\r\n}\r\n\r\nexport const getShareInfo = () => {\r\n  if (location.hash) {\r\n    const info = parseShareStr(location.hash.slice(1))\r\n    location.hash = '#'\r\n    if (info) return info\r\n  }\r\n  return null\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/share.js"],"sourceRoot":""}