{"version":3,"sources":["webpack:///webpack/bootstrap c5157da303bdc9a24c80","webpack:///./src/consts.js","webpack:///./src/buttons.js","webpack:///./src/animate.js","webpack:///./src/texts.js","webpack:///./src/game.js","webpack:///./src/simple-gl/index.js","webpack:///./src/simple-gl/rect.v.glsl","webpack:///./src/simple-gl/rect.f.glsl","webpack:///./src/tiles.js","webpack:///./src/dot-fonts/letters.js","webpack:///./src/dot-fonts/numbers.js","webpack:///./src/dot-fonts/symbols.js","webpack:///./src/dot-fonts/special.js","webpack:///./src/cover.js","webpack:///./src/levels/tutorial-1.js","webpack:///./src/levels/tutorial-2.js","webpack:///./src/levels/tutorial-3.js","webpack:///./src/generator.js"],"names":["COLOR_R","COLOR_G","COLOR_B","transformColorStr","colorStr","r","parseInt","slice","g","b","COLOR_R_ARR","COLOR_G_ARR","COLOR_B_ARR","COLOR_BG_ARR","COLOR_BTN_NORMAL_ARR","COLOR_BTN_ACTIVE_ARR","COLOR_BTN_FLASH_ARR","R","G","B","MAP_LETTER_NUM_MAP","y","c","p","w","FLASH_ANIMATION_LENGTH","createButton","stage","h","margin","cb","container","createContainer","append","createRect","color","bind","activateButton","index","deactivateButton","flashButton","buttonFlashing","btn","setAlpha","curAlpha","flash","x","alpha","unflashButton","animateObj","obj","toPos","length","fromX","fromY","fromAlpha","toX","toY","toAlpha","endTime","Date","now","updateFunc","time","timeLeft","ratio","Math","sqrt","requestAnimationFrame","dotsPositions","Object","create","dotsInfo","prepareFonts","letter","dotStr","lines","split","indexOf","shift","left","right","infoArr","JSON","parse","info","width","height","n","arr","lineContent","m","push","k","createTexts","str","size","i","dotsPosArr","dotSize","forEach","rect","tileUtils","changeOrientation","isVertical","init","canvas","root","getRootContainer","mainContainer","coverContainer","coverUtils","onSelect","type","clear","levels","nextLevel","item","showCover","loadLevel","timeUsed","quit","levelNum","level","window","open","rectVs","require","rectFs","createVertexShader","gl","src","shaderLog","shader","createShader","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","Error","createFragmentShader","FRAGMENT_SHADER","createShaderProgram","vs","fs","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","SimpleAttribBuffer","attribName","count","_gl","_size","_count","glBuf","_glBuf","createBuffer","buf","_buf","Float32Array","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","attribLocation","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","SimpleUniform","uniformName","_loc","getUniformLocation","z","uniform1f","uniform2f","uniform3f","uniform4f","SimpleGLObject","simpleGL","_bindings","s","d","_blendMode","_triggerBinding","blendMode","blendColor","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","name","detail","func","call","pos","_handleEvent","SimpleRect","useProgram","uCanvasSize","_width","_height","_rectGL","aPoint","uColor","_simpleGL","a","relX","relY","relAlpha","_prepareObject","getFloat32Array","write","set","drawArrays","TRIANGLE_FAN","SimpleContainer","_children","child","unshift","before","splice","node","_draw","SimpleGL","getContext","enable","BLEND","viewport","clearColor","clearDepth","_canvas","_rootContainer","_init","setAutoUpdate","status","_autoUpdate","checkUpdate","_scheduledChecking","update","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","args","userClickEnabled","userColor","map","originalMapJSON","steps","startTime","timeTobj","currentTutorialStep","tutorialSteps","levelEndCb","tilesContainer","TILE_AREA_MARGIN","bgContainer","fgContainer","animateContainer","tutorialContainer","metaContainer","colorHintContainer","levelInfoContainer","menuContainer","userColorSelectContainer","drawBackground","j","M_N_MAX","toPixelPos","tile","TILE_SIZE","handleUserClick","initTileContainers","singleTileContainer","refreshTiles","num","tileType","colorSelectButtons","colorHints","resetMetaContainer","showTitle","titleText","maxColor","TITLE_SIZE","TIME_SIZE","TITLE_COLOR_ARR","titleContainer","timeContainer","setInterval","timeDiff","floor","minuteStr","secondStr","String","showMenuButtons","resetButton","resetLevel","resetText","quitButton","endLevel","quitText","showMapInfo","mapInfoContainer","refreshColorSelectButtons","drawColorHint","SIZE","INTERVAL","INITIAL_X","rowOffset","text","endX","drawUserColorSelect","SPACING","BORDER_SIZE","btns","acceptUserClick","findTileRectByColor","forEachChild","cloneRect","ret","checkColorToAdj","toM","toN","srcRect","srcPos","midPos","oldRect","remove","ANIMATION_LENGTH","eraseColor","checkLevelEnd","addColor","colorArr","from","to","parseLevelStr","mapStr","stringify","hasR","hasG","hasB","title","difficulty","seed","clearInterval","TILE_MARGIN","tileBetween","signs","match","line","A","C","D","E","F","H","I","J","K","L","M","N","O","P","Q","S","T","U","V","W","X","Y","Z","selectCb","title1","title2","title3","title4","tutorialButton","tutorialText1","tutorialText2","endlessContainer","endlessButton","endlessText1","endlessText2","authorContainer","authorText","authorTextBg","D_PER_LEVEL","D_COLOR_COUNT","D_STEP_BATCH","D_STEP_SAME_POINT","P_SYMMETRY_NONE","P_SYMMETRY_H","P_SYMMETRY_V","P_SYMMETRY_ROTATE","P_SYMMETRY_ALL","P_SYMMETRY_ALL_ROTATE","P_SYMMETRY_NONE_INC","P_SYMMETRY_H_INC","P_SYMMETRY_V_INC","P_SYMMETRY_ROTATE_INC","P_SYMMETRY_ALL_INC","P_SYMMETRY_ALL_ROTATE_INC","SYMMETRY_INC_LEVELS","FAIL_STEP","P_2_COLOR_D_MIN","P_3_COLOR_D_MIN","P_2_COLOR_D_INC","P_3_COLOR_D_INC","SYMMETRY_NONE","SYMMETRY_H","SYMMETRY_V","SYMMETRY_ROTATE","SYMMETRY_ALL","SYMMETRY_ALL_ROTATE","levelToDifficulty","endless","random","curSeed","curRandMul","getRandom","max","prevRandMul","colorMap","opCountMap","symmetryRand","symmetryType","symmetryIncLevels","min","colorKey","colorRand","colors","colorType","pColor2","pColor3","currentD","nextStep","stepColor","availablePos","stepM","stepN","stepSamePoint","signMap","weightMap","stepCount","setSignMap","stepD","allowFailStep","levelObj"],"mappings":"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","file":"game.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c5157da303bdc9a24c80","const COLOR_R = '#e75885'\r\nconst COLOR_G = '#2f9134'\r\nconst COLOR_B = '#228eda'\r\n\r\nconst transformColorStr = (colorStr) => {\r\n  const r = parseInt(colorStr.slice(1, 3), 16) / 255\r\n  const g = parseInt(colorStr.slice(3, 5), 16) / 255\r\n  const b = parseInt(colorStr.slice(5, 7), 16) / 255\r\n  return [r, g, b, 0.7]\r\n}\r\nexport const COLOR_R_ARR = transformColorStr(COLOR_R)\r\nexport const COLOR_G_ARR = transformColorStr(COLOR_G)\r\nexport const COLOR_B_ARR = transformColorStr(COLOR_B)\r\nexport const COLOR_BG_ARR = [0.1, 0.1, 0.1, 1]\r\n\r\nexport const COLOR_BTN_NORMAL_ARR = [0.2, 0.2, 0.2, 1]\r\nexport const COLOR_BTN_ACTIVE_ARR = [0.6, 0.6, 0.6, 1]\r\nexport const COLOR_BTN_FLASH_ARR = [0.9, 0.9, 0.9, 1]\r\n\r\nexport const R = 1\r\nexport const G = 2\r\nexport const B = 4\r\n\r\nexport const MAP_LETTER_NUM_MAP = {\r\n  '-': 0,\r\n  r: R,\r\n  g: G,\r\n  b: B,\r\n  y: R | G,\r\n  c: G | B,\r\n  p: R | B,\r\n  w: R | G | B,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/consts.js","import {\r\n  COLOR_BG_ARR,\r\n  COLOR_BTN_NORMAL_ARR,\r\n  COLOR_BTN_ACTIVE_ARR,\r\n  COLOR_BTN_FLASH_ARR,\r\n} from './consts'\r\nimport { animateObj } from './animate'\r\n\r\nconst FLASH_ANIMATION_LENGTH = 1000\r\n\r\nexport const createButton = (stage, w, h, margin, cb) => {\r\n  const container = stage.createContainer()\r\n  container.append(stage.createRect(-margin, -margin, w + margin * 2, h + margin * 2).color(...COLOR_BTN_NORMAL_ARR).bind('click', cb || function() { /* empty */ }))\r\n  container.append(stage.createRect(0, 0, w, h).color(...COLOR_BG_ARR))\r\n  return container\r\n}\r\nexport const activateButton = (container) => {\r\n  container.index(0).color(...COLOR_BTN_ACTIVE_ARR)\r\n}\r\nexport const deactivateButton = (container) => {\r\n  container.index(0).color(...COLOR_BTN_NORMAL_ARR)\r\n}\r\nexport const flashButton = (container) => {\r\n  if (container.buttonFlashing) return\r\n  container.buttonFlashing = true\r\n  const btn = container.index(0).color(...COLOR_BTN_FLASH_ARR).setAlpha(0)\r\n  let curAlpha = 0\r\n  const flash = () => {\r\n    if (!container.buttonFlashing) {\r\n      activateButton(container)\r\n      return\r\n    }\r\n    curAlpha = 1 - curAlpha\r\n    animateObj(btn, {\r\n      x: btn.x,\r\n      y: btn.y,\r\n      alpha: curAlpha\r\n    }, FLASH_ANIMATION_LENGTH, flash)\r\n  }\r\n  flash()\r\n}\r\nexport const unflashButton = (container) => {\r\n  container.buttonFlashing = false\r\n  container.index(0).color(...COLOR_BTN_NORMAL_ARR)\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/buttons.js","export const animateObj = (obj, toPos, length, cb) => {\r\n  const fromX = obj.x\r\n  const fromY = obj.y\r\n  const fromAlpha = obj.alpha\r\n  const toX = toPos.x\r\n  const toY = toPos.y\r\n  const toAlpha = toPos.alpha\r\n  const endTime = Date.now() + length\r\n  const updateFunc = () => {\r\n    const time = Date.now()\r\n    const timeLeft = endTime - time > 0 ? endTime - time : 0\r\n    const ratio = 1 - Math.sqrt(1 - timeLeft / length)\r\n    const x = toX - ratio * (toX - fromX)\r\n    const y = toY - ratio * (toY - fromY)\r\n    const alpha = toAlpha - ratio * (toAlpha - fromAlpha)\r\n    obj.x = x\r\n    obj.y = y\r\n    obj.alpha = alpha\r\n    if (timeLeft) requestAnimationFrame(updateFunc)\r\n    else if (cb) return cb()\r\n  }\r\n  requestAnimationFrame(updateFunc)\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/animate.js","import LETTERS from './dot-fonts/letters'\r\nimport NUMBERS from './dot-fonts/numbers'\r\nimport SYMBOLS from './dot-fonts/symbols'\r\nimport SPECIAL from './dot-fonts/special'\r\n\r\nconst dotsPositions = Object.create(null)\r\nconst dotsInfo = Object.create(null)\r\n\r\nconst prepareFonts = (letter, dotStr) => {\r\n  const lines = dotStr.split('\\n')\r\n  while(lines[0].indexOf('[') < 0) lines.shift()\r\n  const left = lines[0].indexOf('[')\r\n  const right = lines[0].indexOf(']') + 1\r\n  const infoArr = JSON.parse(lines[0].slice(left, right))\r\n  const info = {width: infoArr[0], height: infoArr[1]}\r\n  let n = 0\r\n  const arr = []\r\n  for(lines.shift(); lines.length; lines.shift(), n++) {\r\n    const lineContent = lines[0].slice(left, left + info.width)\r\n    for(let m = 0; m < lineContent.length; m++) {\r\n      if (lineContent[m] === '+') {\r\n        arr.push([m, n])\r\n      }\r\n    }\r\n  }\r\n  dotsPositions[letter] = arr\r\n  dotsInfo[letter] = info\r\n}\r\nfor(let k in LETTERS) prepareFonts(k, LETTERS[k])\r\nfor(let k in NUMBERS) prepareFonts(k, NUMBERS[k])\r\nfor(let k in SYMBOLS) prepareFonts(k, SYMBOLS[k])\r\nfor(let k in SPECIAL) prepareFonts(k, SPECIAL[k])\r\n\r\nexport const createTexts = (stage, str, size, color) => {\r\n  const container = stage.createContainer()\r\n  let x = 0\r\n  for(let i = 0; i < str.length; i++) {\r\n    const dotsPosArr = dotsPositions[str[i]]\r\n    const info = dotsInfo[str[i]]\r\n    const dotSize = size / info.height\r\n    // eslint-disable-next-line no-loop-func\r\n    dotsPosArr.forEach(([m, n]) => {\r\n      const rect = stage.createRect(m * dotSize + x, n * dotSize, dotSize, dotSize).color(...color)\r\n      container.append(rect)\r\n    })\r\n    x += dotSize * info.width\r\n  }\r\n  return container\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/texts.js","import { SimpleGL } from './simple-gl'\r\nimport tiles from './tiles'\r\nimport cover from './cover'\r\nimport TUTORIAL_1 from './levels/tutorial-1'\r\nimport TUTORIAL_2 from './levels/tutorial-2'\r\nimport TUTORIAL_3 from './levels/tutorial-3'\r\nimport { endless } from './generator'\r\n\r\nlet tileUtils = null\r\n\r\n/* eslint-disable no-use-before-define */\r\n\r\nexport const changeOrientation = (isVertical) => {\r\n  tileUtils.changeOrientation(isVertical)\r\n}\r\n\r\nexport const init = (canvas, isVertical) => {\r\n  const stage = new SimpleGL(canvas)\r\n  const root = stage.getRootContainer()\r\n\r\n  // init main container for tiles\r\n  const mainContainer = stage.createContainer()\r\n  tileUtils = tiles(stage, mainContainer)\r\n  if (isVertical) tileUtils.changeOrientation(isVertical)\r\n\r\n  // init cover\r\n  const coverContainer = stage.createContainer()\r\n  const coverUtils = cover(stage, coverContainer)\r\n  if (isVertical) coverUtils.changeOrientation(isVertical)\r\n  coverUtils.onSelect((type) => {\r\n    if (type === 'tutorial') {\r\n      root.clear().append(mainContainer)\r\n      const levels = [TUTORIAL_1(), TUTORIAL_2(), TUTORIAL_3()]\r\n      const nextLevel = (item) => {\r\n        if (!levels.length) return showCover()\r\n        tileUtils.loadLevel(levels.shift(), ({timeUsed, quit}) => {\r\n          if (quit) return showCover()\r\n          nextLevel()\r\n        })\r\n      }\r\n      nextLevel()\r\n    } else if (type === 'endless') {\r\n      let levelNum = 0\r\n      root.clear().append(mainContainer)\r\n      const nextLevel = ({timeUsed, quit}) => {\r\n        if (quit) return showCover()\r\n        tileUtils.loadLevel(endless({\r\n          level: ++levelNum,\r\n          timeUsed\r\n        }), nextLevel)\r\n      }\r\n      nextLevel({\r\n        timeUsed: 0\r\n      })\r\n    } else {\r\n      window.open('https://github.com/LastLeaf/tricolors')\r\n    }\r\n  })\r\n\r\n  const showCover = () => {\r\n    root.clear().append(coverContainer)\r\n  }\r\n  showCover()\r\n\r\n  return stage\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/game.js","const rectVs = require('./rect.v.glsl')\r\nconst rectFs = require('./rect.f.glsl')\r\n\r\nconst createVertexShader = (gl, src) => {\r\n  let shaderLog = ''\r\n  const shader = gl.createShader(gl.VERTEX_SHADER)\r\n  gl.shaderSource(shader, src)\r\n  gl.compileShader(shader)\r\n  if(!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n    shaderLog = gl.getShaderInfoLog(shader)\r\n    gl.deleteShader(shader)\r\n    throw new Error('Failed initializing WebGL vertex shader: ' + shaderLog)\r\n  }\r\n  return shader\r\n}\r\n\r\nconst createFragmentShader = (gl, src) => {\r\n  let shaderLog = ''\r\n  const shader = gl.createShader(gl.FRAGMENT_SHADER)\r\n  gl.shaderSource(shader, src)\r\n  gl.compileShader(shader)\r\n  if(!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n    shaderLog = gl.getShaderInfoLog(shader)\r\n    gl.deleteShader(shader)\r\n    throw new Error('Failed initializing WebGL fragment shader: ' + shaderLog)\r\n  }\r\n  return shader\r\n}\r\n\r\nconst createShaderProgram = (gl, vs, fs) => {\r\n  var shaderProgram = gl.createProgram()\r\n  gl.attachShader(shaderProgram, vs)\r\n  gl.attachShader(shaderProgram, fs)\r\n  gl.linkProgram(shaderProgram)\r\n  if(!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\r\n    throw new Error('Failed initializing WebGL shader program.')\r\n  }\r\n  return shaderProgram\r\n}\r\n\r\nclass SimpleAttribBuffer {\r\n  constructor(gl, shaderProgram, attribName, size, count) {\r\n    this._gl = gl\r\n    this._size = size\r\n    this._count = count\r\n    const glBuf = this._glBuf = gl.createBuffer()\r\n    const buf = this._buf = new window.Float32Array(size * count)\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, glBuf)\r\n    gl.bufferData(gl.ARRAY_BUFFER, buf, gl.DYNAMIC_DRAW)\r\n    const attribLocation = gl.getAttribLocation(shaderProgram, attribName)\r\n    gl.enableVertexAttribArray(attribLocation)\r\n    gl.vertexAttribPointer(attribLocation, size, gl.FLOAT, false, 0, 0)\r\n  }\r\n  getFloat32Array() {\r\n    return this._buf\r\n  }\r\n  write() {\r\n    const gl = this._gl\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, this._glBuf)\r\n    gl.bufferData(gl.ARRAY_BUFFER, this._buf, gl.DYNAMIC_DRAW)\r\n  }\r\n}\r\n\r\nclass SimpleUniform {\r\n  constructor(gl, shaderProgram, uniformName, size) {\r\n    this._gl = gl\r\n    this._size = size\r\n    this._loc = gl.getUniformLocation(shaderProgram, uniformName)\r\n  }\r\n  set(x, y, z, w) {\r\n    const gl = this._gl\r\n    const size = this._size\r\n    if (size === 1) {\r\n      gl.uniform1f(this._loc, x)\r\n    } else if (size === 2) {\r\n      gl.uniform2f(this._loc, x, y)\r\n    } else if (size === 3) {\r\n      gl.uniform3f(this._loc, x, y, z)\r\n    } else {\r\n      gl.uniform4f(this._loc, x, y, z, w)\r\n    }\r\n  }\r\n}\r\n\r\nclass SimpleGLObject {\r\n  constructor(simpleGL) {\r\n    this._gl = simpleGL._gl\r\n    this.alpha = 1\r\n    this._bindings = Object.create(null)\r\n  }\r\n  setAlpha(alpha) {\r\n    this.alpha = alpha\r\n    return this\r\n  }\r\n  blendMode(s, d, c) {\r\n    const gl = this._gl\r\n    this._blendMode = [gl[s], gl[d], c]\r\n    return this\r\n  }\r\n  _prepareObject() {\r\n    const gl = this._gl\r\n    this._triggerBinding('draw')\r\n    const blendMode = this._blendMode\r\n    if (blendMode) {\r\n      if(blendMode[2]) gl.blendColor(blendMode[2][0], blendMode[2][1], blendMode[2][2], blendMode[2][3])\r\n      gl.blendFunc(blendMode[0], blendMode[1])\r\n    } else {\r\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA)\r\n    }\r\n  }\r\n  bind(name, cb) {\r\n    if (!this._bindings[name]) {\r\n      this._bindings[name] = [cb]\r\n    } else {\r\n      this._bindings[name].push(cb)\r\n    }\r\n    return this\r\n  }\r\n  _triggerBinding(name, detail) {\r\n    const arr = this._bindings[name]\r\n    if (!arr) return\r\n    arr.forEach((func) => {\r\n      func.call(this, detail)\r\n    })\r\n  }\r\n  emit(pos, name, detail) {\r\n    this._handleEvent(pos, name, detail)\r\n  }\r\n  // eslint-disable-next-line class-methods-use-this\r\n  _handleEvent(pos, name, detail) {\r\n    throw new Error('Not implemented')\r\n  }\r\n}\r\n\r\nclass SimpleRect extends SimpleGLObject {\r\n  static _init(simpleGL) {\r\n    const gl = simpleGL._gl\r\n    const vs = createVertexShader(gl, rectVs)\r\n    const fs = createFragmentShader(gl, rectFs)\r\n    const shaderProgram = createShaderProgram(gl, vs, fs)\r\n    gl.useProgram(shaderProgram)\r\n    const uCanvasSize = gl.getUniformLocation(shaderProgram, 'uCanvasSize')\r\n    gl.uniform2f(uCanvasSize, simpleGL._width, simpleGL._height)\r\n    simpleGL._rectGL = {\r\n      shaderProgram,\r\n      aPoint: new SimpleAttribBuffer(gl, shaderProgram, 'aPoint', 2, 4),\r\n      uColor: new SimpleUniform(gl, shaderProgram, 'uColor', 4),\r\n    }\r\n  }\r\n  constructor(simpleGL, x = 0, y = 0, w = 0, h = 0) {\r\n    super(simpleGL)\r\n    this._simpleGL = simpleGL\r\n    this._gl = simpleGL._gl\r\n    this.x = x\r\n    this.y = y\r\n    this.w = w\r\n    this.h = h\r\n    this.r = 0\r\n    this.g = 0\r\n    this.b = 0\r\n    this.a = 0\r\n  }\r\n  color(r, g, b, a) {\r\n    this.r = r\r\n    this.g = g\r\n    this.b = b\r\n    this.a = a\r\n    return this\r\n  }\r\n  pos(x, y) {\r\n    this.x = x\r\n    this.y = y\r\n    return this\r\n  }\r\n  size(w, h) {\r\n    this.w = w\r\n    this.h = h\r\n    return this\r\n  }\r\n  _draw(relX, relY, relAlpha) {\r\n    const gl = this._gl\r\n    const info = this._simpleGL._rectGL\r\n    gl.useProgram(info.shaderProgram)\r\n    this._prepareObject()\r\n    const aPoint = info.aPoint.getFloat32Array()\r\n    const {x, y, w, h, r, g, b, a} = this\r\n    aPoint[0] = relX + x\r\n    aPoint[1] = relY + y\r\n    aPoint[2] = relX + x\r\n    aPoint[3] = relY + y + h\r\n    aPoint[4] = relX + x + w\r\n    aPoint[5] = relY + y + h\r\n    aPoint[6] = relX + x + w\r\n    aPoint[7] = relY + y\r\n    info.aPoint.write()\r\n    info.uColor.set(r, g, b, a * this.alpha * relAlpha)\r\n    gl.drawArrays(gl.TRIANGLE_FAN, 0, 4)\r\n  }\r\n  _handleEvent(pos, name, detail) {\r\n    if (pos.x < this.x) return\r\n    if (pos.x >= this.x + this.w) return\r\n    if (pos.y < this.y) return\r\n    if (pos.y >= this.y + this.h) return\r\n    this._triggerBinding(name, detail)\r\n  }\r\n}\r\n\r\nclass SimpleContainer extends SimpleGLObject {\r\n  constructor(simpleGL, x = 0, y = 0) {\r\n    super(simpleGL)\r\n    this._simpleGL = simpleGL\r\n    this._gl = simpleGL._gl\r\n    this.x = x\r\n    this.y = y\r\n    this._children = []\r\n  }\r\n  pos(x, y) {\r\n    this.x = x\r\n    this.y = y\r\n    return this\r\n  }\r\n  blendMode(s, d, c) {\r\n    this._children.forEach((item) => {\r\n      item.blendMode(s, d, c)\r\n    })\r\n    return this\r\n  }\r\n  forEachChild(func) {\r\n    return this._children.forEach(func)\r\n  }\r\n  index(i) {\r\n    return this._children[i]\r\n  }\r\n  append(child) {\r\n    this._children.push(child)\r\n    return this\r\n  }\r\n  prepend(child) {\r\n    this._children.unshift(child)\r\n    return this\r\n  }\r\n  insert(child, before) {\r\n    const index = this._children.indexOf(before)\r\n    if (index >= 0) this._children.splice(index, 0, child)\r\n    return this\r\n  }\r\n  remove(child) {\r\n    const index = this._children.indexOf(child)\r\n    if (index >= 0) this._children.splice(index, 1)\r\n    return this\r\n  }\r\n  clear() {\r\n    while(this._children.length) this._children.shift()\r\n    return this\r\n  }\r\n  _draw(relX, relY, relAlpha) {\r\n    this._prepareObject()\r\n    this._children.forEach((node) => {\r\n      node._draw(relX + this.x, relY + this.y, this.alpha * relAlpha)\r\n    })\r\n  }\r\n  _handleEvent(pos, name, detail) {\r\n    this._children.forEach((node) => {\r\n      node._handleEvent({\r\n        x: pos.x - this.x,\r\n        y: pos.y - this.y\r\n      }, name, detail)\r\n    })\r\n  }\r\n}\r\n\r\nexport class SimpleGL {\r\n  constructor(canvas) {\r\n    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl')\r\n    gl.enable(gl.BLEND)\r\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA)\r\n    gl.viewport(0, 0, canvas.width, canvas.height)\r\n    gl.clearColor(0.0, 0.0, 0.0, 0.0)\r\n    gl.clearDepth(1)\r\n    this._canvas = canvas\r\n    this._gl = gl\r\n    this._width = canvas.width\r\n    this._height = canvas.height\r\n    this._rootContainer = new SimpleContainer(this, 0, 0)\r\n    SimpleRect._init(this)\r\n    this.setAutoUpdate(true)\r\n  }\r\n  setAutoUpdate(status) {\r\n    this._autoUpdate = status\r\n    if (status) {\r\n      const checkUpdate = () => {\r\n        this._scheduledChecking = false\r\n        if (!this._autoUpdate) return\r\n        requestAnimationFrame(checkUpdate)\r\n        this._scheduledChecking = true\r\n        this.update()\r\n      }\r\n      if (!this._scheduledChecking) {\r\n        requestAnimationFrame(checkUpdate)\r\n        this._scheduledChecking = true\r\n      }\r\n    }\r\n  }\r\n  update() {\r\n    const gl = this._gl\r\n    gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT)\r\n    this._rootContainer._draw(0, 0, 1)\r\n  }\r\n  getRootContainer() {\r\n    return this._rootContainer\r\n  }\r\n  createContainer(...args) {\r\n    return new SimpleContainer(this, ...args)\r\n  }\r\n  createRect(...args) {\r\n    return new SimpleRect(this, ...args)\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/simple-gl/index.js","module.exports = \"attribute vec2 aPoint;\\r\\nuniform vec2 uCanvasSize;\\r\\n\\r\\nvoid main(void) {\\r\\n  gl_Position = vec4(aPoint * mat2( 2.0/uCanvasSize.x,0, 0,-2.0/uCanvasSize.y ) + vec2(-1, 1), 0, 1);\\r\\n}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/simple-gl/rect.v.glsl\n// module id = 6\n// module chunks = 0","module.exports = \"uniform highp vec4 uColor;\\r\\n\\r\\nvoid main(void) {\\r\\n  gl_FragColor = uColor;\\r\\n}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/simple-gl/rect.f.glsl\n// module id = 7\n// module chunks = 0","import {\r\n  COLOR_R_ARR,\r\n  COLOR_G_ARR,\r\n  COLOR_B_ARR,\r\n  COLOR_BG_ARR,\r\n  R,\r\n  G,\r\n  B,\r\n  MAP_LETTER_NUM_MAP,\r\n} from './consts'\r\nimport {\r\n  createButton,\r\n  activateButton,\r\n  deactivateButton,\r\n  flashButton,\r\n  unflashButton,\r\n} from './buttons'\r\nimport { createTexts } from './texts'\r\nimport { animateObj } from './animate'\r\n\r\nconst M_N_MAX = 5\r\nconst TILE_SIZE = 150\r\nconst TILE_MARGIN = 50\r\nconst TILE_AREA_MARGIN = (1080 - TILE_SIZE * M_N_MAX - TILE_MARGIN * (M_N_MAX - 1)) / 2\r\nconst ANIMATION_LENGTH = 200\r\n\r\nconst toPixelPos = (m, n, alpha) => {\r\n  const tileBetween = TILE_SIZE + TILE_MARGIN\r\n  return {\r\n    x: m * tileBetween,\r\n    y: n * tileBetween,\r\n    alpha: alpha\r\n  }\r\n}\r\n\r\nconst parseLevelStr = (str) => {\r\n  const signs = str.match(/[-rgbycpw]/g)\r\n  const map = []\r\n  for(let j = 0; j < M_N_MAX; j++) {\r\n    const line = []\r\n    for(let i = 0; i < M_N_MAX; i++) {\r\n      line.push(MAP_LETTER_NUM_MAP[signs.shift()])\r\n    }\r\n    map.push(line)\r\n  }\r\n  return map\r\n}\r\n\r\n/* eslint-disable no-use-before-define */\r\n\r\nexport default function(stage, mainContainer) {\r\n  // game states\r\n  let userClickEnabled = false\r\n  let userColor = R | G | B\r\n  let map = null\r\n  let originalMapJSON = null\r\n  let steps = []\r\n  let startTime = 0\r\n  let timeTobj = null\r\n  let currentTutorialStep = null\r\n  let tutorialSteps = null\r\n  let levelEndCb = null\r\n\r\n  // base containers\r\n  const tilesContainer = stage.createContainer()\r\n  mainContainer.append(tilesContainer)\r\n  tilesContainer.pos(1920 - 1080 + TILE_AREA_MARGIN, TILE_AREA_MARGIN)\r\n  const bgContainer = stage.createContainer()\r\n  const fgContainer = stage.createContainer()\r\n  const animateContainer = stage.createContainer()\r\n  const tutorialContainer = stage.createContainer()\r\n  tilesContainer.append(tutorialContainer).append(bgContainer).append(fgContainer).append(animateContainer)\r\n\r\n  // meta containers\r\n  const metaContainer = stage.createContainer()\r\n  mainContainer.append(metaContainer)\r\n  metaContainer.pos(TILE_AREA_MARGIN, TILE_AREA_MARGIN)\r\n  const colorHintContainer = stage.createContainer(0, 1080 - TILE_AREA_MARGIN * 2 - 200)\r\n  const levelInfoContainer = stage.createContainer(0, 40)\r\n  const menuContainer = stage.createContainer(1080 - TILE_AREA_MARGIN, 30)\r\n  const userColorSelectContainer = stage.createContainer(0, 1080 - TILE_AREA_MARGIN * 2)\r\n  metaContainer.append(colorHintContainer).append(levelInfoContainer).append(userColorSelectContainer).append(menuContainer)\r\n\r\n  // add background tiles\r\n  const drawBackground = () => {\r\n    for(let j = 0; j < M_N_MAX; j++) {\r\n      // eslint-disable-next-line no-loop-func\r\n      for(let i = 0; i < M_N_MAX; i++) ((i, j) => {\r\n        const {x, y} = toPixelPos(i, j)\r\n        const tile = stage.createRect(x, y, TILE_SIZE, TILE_SIZE).color(...COLOR_BG_ARR)\r\n        bgContainer.append(tile)\r\n        tile.bind('click', () => {\r\n          handleUserClick(i, j)\r\n        })\r\n      })(i, j)\r\n    }\r\n  }\r\n  drawBackground()\r\n\r\n  // draw foreground tiles\r\n  const initTileContainers = () => {\r\n    for(let j = 0; j < M_N_MAX; j++) {\r\n      for(let i = 0; i < M_N_MAX; i++) {\r\n        const {x, y} = toPixelPos(i, j)\r\n        const singleTileContainer = stage.createContainer(x, y)\r\n        fgContainer.append(singleTileContainer)\r\n      }\r\n    }\r\n  }\r\n  initTileContainers()\r\n  const refreshTiles = () => {\r\n    for(let j = 0; j < M_N_MAX; j++) {\r\n      for(let i = 0; i < M_N_MAX; i++) {\r\n        const num = map[j][i]\r\n        const singleTileContainer = fgContainer.index(j * M_N_MAX + i)\r\n        singleTileContainer.clear()\r\n        if (num & R) {\r\n          const rect = stage.createRect(0, 0, TILE_SIZE, TILE_SIZE).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n          rect.tileType = R\r\n          singleTileContainer.append(rect)\r\n        }\r\n        if (num & G) {\r\n          const rect = stage.createRect(0, 0, TILE_SIZE, TILE_SIZE).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n          rect.tileType = G\r\n          singleTileContainer.append(rect)\r\n        }\r\n        if (num & B) {\r\n          const rect = stage.createRect(0, 0, TILE_SIZE, TILE_SIZE).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n          rect.tileType = B\r\n          singleTileContainer.append(rect)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // show user color status\r\n  let colorSelectButtons = []\r\n  let colorHints = {}\r\n  const resetMetaContainer = () => {\r\n    colorSelectButtons = []\r\n    colorHintContainer.clear()\r\n    levelInfoContainer.clear()\r\n    userColorSelectContainer.clear()\r\n  }\r\n  const showTitle = (titleText, maxColor) => {\r\n    const TITLE_SIZE = 100\r\n    const TIME_SIZE = 40\r\n    const TITLE_COLOR_ARR = [0.5, 0.5, 0.5, 1]\r\n    const titleContainer = createTexts(stage, titleText, TITLE_SIZE, TITLE_COLOR_ARR)\r\n    const timeContainer = stage.createContainer(0, TITLE_SIZE + 20)\r\n    levelInfoContainer.append(titleContainer).append(timeContainer)\r\n    timeTobj = setInterval(() => {\r\n      const timeDiff = Math.floor((Date.now() - startTime) / 1000)\r\n      const minuteStr = (timeDiff < 600 ? '0' : '') + Math.floor(timeDiff / 60)\r\n      const secondStr = ':' + String(timeDiff % 60 + 100).slice(1)\r\n      timeContainer.clear()\r\n      timeContainer.append(createTexts(stage, minuteStr + secondStr, TIME_SIZE, TITLE_COLOR_ARR))\r\n    }, 1000)\r\n  }\r\n  const showMenuButtons = () => {\r\n    const resetButton = createButton(stage, 70, 70, 10, () => {\r\n      if (!userClickEnabled) return\r\n      if (currentTutorialStep) return\r\n      resetLevel()\r\n    }).pos(-260, 0)\r\n    const resetText = createTexts(stage, '\\x02', 70, [0.4, 0.4, 0.4, 1]).pos(-255, 5)\r\n    const quitButton = createButton(stage, 70, 70, 10, () => {\r\n      if (!userClickEnabled) return\r\n      if (currentTutorialStep) return\r\n      endLevel(true)\r\n    }).pos(-140, 0)\r\n    const quitText = createTexts(stage, '\\x03', 70, [0.4, 0.4, 0.4, 1]).pos(-135, 5)\r\n    menuContainer.append(resetButton).append(resetText).append(quitButton).append(quitText)\r\n  }\r\n  const showMapInfo = (str) => {\r\n    const mapInfoContainer = createTexts(stage, str, 30, [0.3, 0.3, 0.3, 1]).pos(0, -60)\r\n    levelInfoContainer.append(mapInfoContainer)\r\n  }\r\n  const refreshColorSelectButtons = () => {\r\n    colorSelectButtons.forEach((btn) => {\r\n      if (userColor === btn.userColor) activateButton(btn)\r\n      else deactivateButton(btn)\r\n    })\r\n    colorHintContainer.clear()\r\n    if (colorHints[userColor]) colorHintContainer.append(colorHints[userColor])\r\n  }\r\n  const drawColorHint = (maxColor) => {\r\n    const SIZE = 60\r\n    const INTERVAL = 2.25 * 60\r\n    const INITIAL_X = 22.5\r\n    let y = 0\r\n    ;[R|G, R|B, G|B, R|G|B].forEach((c) => {\r\n      if (maxColor & c) {\r\n        const rowOffset = -10\r\n        const container = stage.createContainer(rowOffset, 0)\r\n        const text = createTexts(stage, c === (R|G|B) ? '  +  +  =' : '  +  =', SIZE, [0.5, 0.5, 0.5, 1])\r\n        container.append(text.pos(0, y))\r\n        let x = INITIAL_X\r\n        let endX = INITIAL_X + INTERVAL * (c === (R|G|B) ? 3 : 2)\r\n        if (c & R) {\r\n          container.append(stage.createRect(x, y, SIZE, SIZE).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          container.append(stage.createRect(endX, y, SIZE, SIZE).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          x += INTERVAL\r\n        }\r\n        if (c & G) {\r\n          container.append(stage.createRect(x, y, SIZE, SIZE).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          container.append(stage.createRect(endX, y, SIZE, SIZE).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          x += INTERVAL\r\n        }\r\n        if (c & B) {\r\n          container.append(stage.createRect(x, y, SIZE, SIZE).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          container.append(stage.createRect(endX, y, SIZE, SIZE).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n          x += INTERVAL\r\n        }\r\n        colorHints[c] = container\r\n      }\r\n    })\r\n  }\r\n  const drawUserColorSelect = (maxColor) => {\r\n    const SPACING = 30\r\n    const BORDER_SIZE = 15\r\n    const SIZE = 70\r\n    let x = 0\r\n    let y = -BORDER_SIZE * 2 - SIZE\r\n    const btns = colorSelectButtons = []\r\n    // eslint-disable-next-line no-loop-func\r\n    ;[R, G, B, R|G, R|B, G|B, R|G|B].forEach((c, index) => {\r\n      if ((maxColor & c) === c) {\r\n        const btn = createButton(stage, SIZE, SIZE, BORDER_SIZE, () => {\r\n          if (currentTutorialStep && (currentTutorialStep[0] !== -1 || currentTutorialStep[1] !== index)) return\r\n          userColor = c\r\n          refreshColorSelectButtons()\r\n          acceptUserClick()\r\n        }).pos(x + BORDER_SIZE, y + BORDER_SIZE)\r\n        btn.userColor = c\r\n        btns.push(btn)\r\n        userColorSelectContainer.append(btn)\r\n        if (c & R) userColorSelectContainer.append(stage.createRect(x + BORDER_SIZE, y + BORDER_SIZE, SIZE, SIZE).color(...COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n        if (c & G) userColorSelectContainer.append(stage.createRect(x + BORDER_SIZE, y + BORDER_SIZE, SIZE, SIZE).color(...COLOR_G_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n        if (c & B) userColorSelectContainer.append(stage.createRect(x + BORDER_SIZE, y + BORDER_SIZE, SIZE, SIZE).color(...COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE'))\r\n        x += BORDER_SIZE * 2 + SIZE + SPACING\r\n      }\r\n    })\r\n  }\r\n\r\n  // controllers\r\n  const findTileRectByColor = (singleTileContainer, color) => {\r\n    let rect = null\r\n    singleTileContainer.forEachChild((item) => {\r\n      if (item.tileType === color) {\r\n        rect = item\r\n        return false\r\n      }\r\n    })\r\n    return rect\r\n  }\r\n  const cloneRect = (rect) => {\r\n    const ret = stage.createRect(rect.x, rect.y, rect.w, rect.h).color(rect.r, rect.g, rect.b, rect.a).blendMode('SRC_ALPHA', 'ONE')\r\n    ret.tileType = rect.tileType\r\n    return ret\r\n  }\r\n  const checkColorToAdj = (m, n, toM, toN, color, srcRect) => {\r\n    if (toM < 0 || toM >= M_N_MAX || toN < 0 || toN >= M_N_MAX) return\r\n    // prepare rect\r\n    const rect = cloneRect(srcRect)\r\n    const srcPos = toPixelPos(m, n, 1)\r\n    const toPos = toPixelPos(toM, toN, 1)\r\n    const midPos = {\r\n      x: (srcPos.x + toPos.x) / 2,\r\n      y: (srcPos.y + toPos.y) / 2,\r\n      alpha: 0\r\n    }\r\n    animateContainer.append(rect)\r\n    const num = map[toN][toM]\r\n    map[toN][toM] ^= color\r\n    if (num & color) {\r\n      // erase\r\n      const singleTileContainer = fgContainer.index(toN * M_N_MAX + toM)\r\n      const oldRect = findTileRectByColor(singleTileContainer, color)\r\n      singleTileContainer.remove(oldRect)\r\n      rect.pos(toPos.x, toPos.y).setAlpha(1)\r\n      animateObj(rect, midPos, ANIMATION_LENGTH)\r\n    } else {\r\n      // add\r\n      rect.pos(midPos.x, midPos.y).setAlpha(0)\r\n      animateObj(rect, toPos, ANIMATION_LENGTH)\r\n    }\r\n  }\r\n  const eraseColor = (m, n, color) => {\r\n    userClickEnabled = false\r\n    map[n][m] ^= color\r\n    // find rect\r\n    const singleTileContainer = fgContainer.index(n * M_N_MAX + m)\r\n    const rect = findTileRectByColor(singleTileContainer, color)\r\n    // handling adjs\r\n    checkColorToAdj(m, n, m - 1, n, color, rect)\r\n    checkColorToAdj(m, n, m + 1, n, color, rect)\r\n    checkColorToAdj(m, n, m, n - 1, color, rect)\r\n    checkColorToAdj(m, n, m, n + 1, color, rect)\r\n    // animate self\r\n    const toPos = {\r\n      x: 0,\r\n      y: 0,\r\n      alpha: 0,\r\n    }\r\n    animateObj(rect, toPos, ANIMATION_LENGTH, () => {\r\n      requestAnimationFrame(() => {\r\n        animateContainer.clear()\r\n        refreshTiles()\r\n        acceptUserClick()\r\n        if (checkLevelEnd()) return\r\n      })\r\n    })\r\n  }\r\n  const addColor = (m, n, color) => {\r\n    userClickEnabled = false\r\n    map[n][m] ^= color\r\n    // create rect\r\n    const singleTileContainer = fgContainer.index(n * M_N_MAX + m)\r\n    const colorArr = {\r\n      [R]: COLOR_R_ARR,\r\n      [G]: COLOR_G_ARR,\r\n      [B]: COLOR_B_ARR,\r\n    }[color]\r\n    const rect = stage.createRect(0, 0, TILE_SIZE, TILE_SIZE).color(...colorArr).blendMode('SRC_ALPHA', 'ONE')\r\n    rect.setAlpha(0)\r\n    singleTileContainer.append(rect)\r\n    // handling adjs\r\n    checkColorToAdj(m, n, m - 1, n, color, rect)\r\n    checkColorToAdj(m, n, m + 1, n, color, rect)\r\n    checkColorToAdj(m, n, m, n - 1, color, rect)\r\n    checkColorToAdj(m, n, m, n + 1, color, rect)\r\n    // animate self\r\n    const toPos = {\r\n      x: 0,\r\n      y: 0,\r\n      alpha: 1,\r\n    }\r\n    animateObj(rect, toPos, ANIMATION_LENGTH, () => {\r\n      requestAnimationFrame(() => {\r\n        animateContainer.clear()\r\n        refreshTiles()\r\n        acceptUserClick()\r\n        if (checkLevelEnd()) return\r\n      })\r\n    })\r\n  }\r\n\r\n  // user click handler\r\n  const handleUserClick = (m, n) => {\r\n    if (!userClickEnabled) return\r\n    if (currentTutorialStep && (currentTutorialStep[0] !== m || currentTutorialStep[1] !== n)) return\r\n    const num = map[n][m]\r\n    steps.push({\r\n      m,\r\n      n,\r\n      from: num,\r\n      to: num ? 0 : userColor\r\n    })\r\n    if (num) {\r\n      userColor = num\r\n      refreshColorSelectButtons()\r\n      if (num & R) eraseColor(m, n, R)\r\n      if (num & G) eraseColor(m, n, G)\r\n      if (num & B) eraseColor(m, n, B)\r\n    } else {\r\n      if (userColor & R) addColor(m, n, R)\r\n      if (userColor & G) addColor(m, n, G)\r\n      if (userColor & B) addColor(m, n, B)\r\n    }\r\n  }\r\n  const acceptUserClick = () => {\r\n    userClickEnabled = true\r\n    if (currentTutorialStep) {\r\n      if (currentTutorialStep[0] === -1) {\r\n        const btn = colorSelectButtons[currentTutorialStep[1]]\r\n        unflashButton(btn)\r\n        activateButton(btn)\r\n      } else {\r\n        tutorialContainer.clear()\r\n      }\r\n    }\r\n    currentTutorialStep = tutorialSteps.shift()\r\n    if (currentTutorialStep) {\r\n      if (currentTutorialStep[0] === -1) {\r\n        const btn = colorSelectButtons[currentTutorialStep[1]]\r\n        flashButton(btn)\r\n      } else {\r\n        const pos = toPixelPos(currentTutorialStep[0], currentTutorialStep[1])\r\n        const btn = createButton(stage, TILE_SIZE, TILE_SIZE, 20, () => {\r\n          unflashButton(btn)\r\n          activateButton(btn)\r\n        }).pos(pos.x, pos.y)\r\n        tutorialContainer.append(btn)\r\n        flashButton(btn)\r\n      }\r\n    }\r\n  }\r\n\r\n  // load map and start\r\n  const loadLevel = (level, cb) => {\r\n    // load level data\r\n    levelEndCb = cb\r\n    tutorialSteps = level.tutorialSteps || []\r\n    currentTutorialStep = null\r\n    map = level.map || parseLevelStr(level.mapStr)\r\n    originalMapJSON = JSON.stringify(map)\r\n    // reset ui\r\n    animateContainer.clear()\r\n    tutorialContainer.clear()\r\n    resetMetaContainer()\r\n    refreshTiles()\r\n    // stat used colors\r\n    let hasR = false\r\n    let hasG = false\r\n    let hasB = false\r\n    for(let j = 0; j < M_N_MAX; j++) {\r\n      for(let i = 0; i < M_N_MAX; i++) {\r\n        const num = map[j][i]\r\n        if (num & R) hasR = true\r\n        if (num & G) hasG = true\r\n        if (num & B) hasB = true\r\n      }\r\n    }\r\n    const maxColor = (hasR ? R : 0) | (hasG ? G : 0) | (hasB ? B : 0)\r\n    userColor = MAP_LETTER_NUM_MAP[level.userColor] || maxColor\r\n    if (maxColor !== R && maxColor !== G && maxColor !== B) {\r\n      drawColorHint(maxColor)\r\n      drawUserColorSelect(maxColor)\r\n      refreshColorSelectButtons()\r\n    }\r\n    // show title\r\n    startTime = Date.now() - (level.timeUsed || 0)\r\n    showTitle(level.title, maxColor)\r\n    showMenuButtons()\r\n    if (level.difficulty) showMapInfo('SEED:' + level.seed + ' D:' + level.difficulty)\r\n    acceptUserClick()\r\n  }\r\n  const resetLevel = () => {\r\n    map = JSON.parse(originalMapJSON)\r\n    refreshTiles()\r\n  }\r\n  const checkLevelEnd = () => {\r\n    let status = -1\r\n    for(let j = 0; j < M_N_MAX; j++) {\r\n      for(let i = 0; i < M_N_MAX; i++) {\r\n        const num = map[j][i]\r\n        if (status < 0) status = num\r\n        else if (status !== num) return false\r\n      }\r\n    }\r\n    endLevel()\r\n    return true\r\n  }\r\n  const endLevel = (quit = false) => {\r\n    clearInterval(timeTobj)\r\n    levelEndCb({\r\n      timeUsed: Date.now() - startTime,\r\n      quit\r\n    })\r\n  }\r\n\r\n  return {\r\n    loadLevel,\r\n    changeOrientation: (isVertical) => {\r\n      if (isVertical) {\r\n        tilesContainer.pos(TILE_AREA_MARGIN, (1920 - 1080) / 2 + TILE_AREA_MARGIN)\r\n        colorHintContainer.pos(0, 1920 - TILE_AREA_MARGIN * 2 - 200)\r\n        userColorSelectContainer.pos(0, 1920 - TILE_AREA_MARGIN * 2)\r\n      }\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/tiles.js","export default {\r\n  A: `\r\n    [6,8]\r\n       +\r\n      + +\r\n     +   +\r\n     +   +\r\n     +++++\r\n     +   +\r\n     +   +\r\n  `,\r\n  B: `\r\n    [6,8]\r\n     ++++\r\n     +   +\r\n     +   +\r\n     ++++\r\n     +   +\r\n     +   +\r\n     ++++\r\n  `,\r\n  C: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +\r\n     +\r\n     +\r\n     +   +\r\n      +++\r\n  `,\r\n  D: `\r\n    [6,8]\r\n     +++\r\n     +  +\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +  +\r\n     +++\r\n  `,\r\n  E: `\r\n    [6,8]\r\n     +++++\r\n     +\r\n     +\r\n     ++++\r\n     +\r\n     +\r\n     +++++\r\n  `,\r\n  F: `\r\n    [6,8]\r\n     +++++\r\n     +\r\n     +\r\n     ++++\r\n     +\r\n     +\r\n     +\r\n  `,\r\n  G: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +\r\n     +  ++\r\n     +   +\r\n     +  ++\r\n      ++ +\r\n  `,\r\n\r\n  H: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +++++\r\n     +   +\r\n     +   +\r\n     +   +\r\n  `,\r\n  I: `\r\n    [6,8]\r\n      +++\r\n       +\r\n       +\r\n       +\r\n       +\r\n       +\r\n      +++\r\n  `,\r\n  J: `\r\n    [6,8]\r\n      +++\r\n       +\r\n       +\r\n       +\r\n       +\r\n     + +\r\n      +\r\n  `,\r\n  K: `\r\n    [6,8]\r\n     +   +\r\n     +  +\r\n     + +\r\n     ++\r\n     + +\r\n     +  +\r\n     +   +\r\n  `,\r\n  L: `\r\n    [6,8]\r\n      +\r\n      +\r\n      +\r\n      +\r\n      +\r\n      +\r\n      ++++\r\n  `,\r\n  M: `\r\n    [6,8]\r\n     +   +\r\n     ++ ++\r\n     + + +\r\n     + + +\r\n     +   +\r\n     +   +\r\n     +   +\r\n  `,\r\n  N: `\r\n    [6,8]\r\n     +   +\r\n     ++  +\r\n     + + +\r\n     +  ++\r\n     +   +\r\n     +   +\r\n     +   +\r\n  `,\r\n\r\n  O: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n      +++\r\n  `,\r\n  P: `\r\n    [6,8]\r\n     +++\r\n     +  +\r\n     +   +\r\n     +  +\r\n     +++\r\n     +\r\n     +\r\n  `,\r\n  Q: `\r\n    [6,8]\r\n     +   +\r\n     ++  +\r\n     + + +\r\n     +  ++\r\n     +   +\r\n     +   +\r\n     +   +\r\n  `,\r\n  R: `\r\n    [6,8]\r\n     ++++\r\n     +   +\r\n     +  +\r\n     +++\r\n     +  +\r\n     +   +\r\n     +   +\r\n  `,\r\n  S: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n      +\r\n       +\r\n        +\r\n     +   +\r\n      +++\r\n  `,\r\n  T: `\r\n    [6,8]\r\n     +++++\r\n       +\r\n       +\r\n       +\r\n       +\r\n       +\r\n       +\r\n  `,\r\n\r\n  U: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +  ++\r\n      ++ +\r\n  `,\r\n  V: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n     +   +\r\n      + +\r\n       +\r\n  `,\r\n  W: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n     +   +\r\n     + + +\r\n     + + +\r\n     + + +\r\n      + +\r\n  `,\r\n  X: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n      + +\r\n       +\r\n      + +\r\n     +   +\r\n     +   +\r\n  `,\r\n  Y: `\r\n    [6,8]\r\n     +   +\r\n     +   +\r\n      + +\r\n       +\r\n       +\r\n       +\r\n       +\r\n  `,\r\n  Z: `\r\n    [6,8]\r\n     +++++\r\n         +\r\n      + +\r\n       +\r\n      + +\r\n     +\r\n     +++++\r\n  `,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/dot-fonts/letters.js","export default {\r\n  0: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +  ++\r\n     + + +\r\n     ++  +\r\n     +   +\r\n      +++\r\n  `,\r\n  1: `\r\n    [6,8]\r\n       +\r\n      ++\r\n       +\r\n       +\r\n       +\r\n       +\r\n      +++\r\n  `,\r\n  2: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n        +\r\n       +\r\n      +\r\n     +\r\n     +++++\r\n  `,\r\n  3: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n         +\r\n       ++\r\n         +\r\n     +   +\r\n      +++\r\n  `,\r\n  4: `\r\n    [6,8]\r\n        +\r\n       ++\r\n      + +\r\n     +  +\r\n     +++++\r\n        +\r\n        +\r\n  `,\r\n  5: `\r\n    [6,8]\r\n     +++++\r\n     +\r\n     +\r\n      +++\r\n         +\r\n     +   +\r\n      +++\r\n  `,\r\n  6: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +\r\n     ++++\r\n     +   +\r\n     +   +\r\n      +++\r\n  `,\r\n  7: `\r\n    [6,8]\r\n     +++++\r\n         +\r\n        +\r\n       +\r\n      +\r\n      +\r\n      +\r\n  `,\r\n  8: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +   +\r\n      +++\r\n     +   +\r\n     +   +\r\n      +++\r\n  `,\r\n  9: `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n     +   +\r\n      ++++\r\n         +\r\n     +   +\r\n      +++\r\n  `,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/dot-fonts/numbers.js","export default {\r\n  ' ': `\r\n    [6,8]\r\n  `,\r\n  '-': `\r\n    [6,8]\r\n\r\n\r\n\r\n     +++++\r\n\r\n\r\n\r\n  `,\r\n  '=': `\r\n    [6,8]\r\n\r\n\r\n     +++++\r\n\r\n     +++++\r\n\r\n\r\n  `,\r\n  '+': `\r\n    [6,8]\r\n\r\n       +\r\n       +\r\n     +++++\r\n       +\r\n       +\r\n\r\n  `,\r\n  '.': `\r\n    [6,8]\r\n\r\n\r\n\r\n\r\n\r\n      ++\r\n      ++\r\n  `,\r\n  ':': `\r\n    [6,8]\r\n\r\n\r\n       +\r\n\r\n\r\n       +\r\n\r\n  `,\r\n  '#': `\r\n    [6,8]\r\n      + +\r\n      + +\r\n     +++++\r\n      + +\r\n     +++++\r\n      + +\r\n      + +\r\n  `,\r\n  '?': `\r\n    [6,8]\r\n      +++\r\n     +   +\r\n         +\r\n        +\r\n       +\r\n\r\n       +\r\n  `,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/dot-fonts/symbols.js","export default {\r\n  '\\x01': `\r\n    [6,8]\r\n     ++\r\n     +++\r\n     ++++\r\n     +++++\r\n     ++++\r\n     +++\r\n     ++\r\n  `,\r\n  '\\x02': `\r\n    [6,8]\r\n\r\n     +++++\r\n      +  +\r\n         +\r\n         +\r\n     +++++\r\n\r\n  `,\r\n  '\\x03': `\r\n    [6,8]\r\n\r\n     +   +\r\n      + +\r\n       +\r\n      + +\r\n     +   +\r\n\r\n  `,\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/dot-fonts/special.js","import {\r\n  COLOR_R_ARR,\r\n  COLOR_G_ARR,\r\n  COLOR_B_ARR,\r\n} from './consts'\r\nimport {\r\n  createButton,\r\n} from './buttons'\r\nimport { createTexts } from './texts'\r\n\r\nexport default (stage, container) => {\r\n  let selectCb = null\r\n\r\n  const titleContainer = stage.createContainer().pos(555, 300)\r\n  const title1 = createTexts(stage, 'TRI', 120, COLOR_R_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const title2 = createTexts(stage, 'TRI', 120, COLOR_B_ARR).blendMode('SRC_ALPHA', 'ONE')\r\n  const title3 = createTexts(stage, 'COLORS', 120, COLOR_G_ARR).pos(270, 0).blendMode('SRC_ALPHA', 'ONE')\r\n  const title4 = createTexts(stage, 'COLORS', 120, COLOR_B_ARR).pos(270, 0).blendMode('SRC_ALPHA', 'ONE')\r\n  titleContainer.append(title1).append(title2).append(title3).append(title4)\r\n  container.append(titleContainer)\r\n\r\n  const tutorialContainer = stage.createContainer().pos(760, 600)\r\n  const tutorialButton = createButton(stage, 140, 140, 20, () => {\r\n    selectCb('tutorial')\r\n  }).pos(-20, -20)\r\n  const tutorialText1 = createTexts(stage, '?', 100, COLOR_R_ARR).pos(5, 10).blendMode('SRC_ALPHA', 'ONE')\r\n  const tutorialText2 = createTexts(stage, '?', 100, COLOR_G_ARR).pos(5, 10).blendMode('SRC_ALPHA', 'ONE')\r\n  tutorialContainer.append(tutorialButton).append(tutorialText1).append(tutorialText2)\r\n  container.append(tutorialContainer)\r\n\r\n  const endlessContainer = stage.createContainer().pos(1060, 600)\r\n  const endlessButton = createButton(stage, 140, 140, 20, () => {\r\n    selectCb('endless')\r\n  }).pos(-20, -20)\r\n  const endlessText1 = createTexts(stage, '\\x01', 100, COLOR_R_ARR).pos(5, 10).blendMode('SRC_ALPHA', 'ONE')\r\n  const endlessText2 = createTexts(stage, '\\x01', 100, COLOR_G_ARR).pos(5, 10).blendMode('SRC_ALPHA', 'ONE')\r\n  endlessContainer.append(endlessButton).append(endlessText1).append(endlessText2)\r\n  container.append(endlessContainer)\r\n\r\n  const authorContainer = stage.createContainer().pos(840, 960)\r\n  const authorText = createTexts(stage, 'LASTLEAF', 40, [0.4, 0.4, 0.4, 1])\r\n  const authorTextBg = stage.createRect(0, 0, 240, 40).color(0, 0, 0, 0).bind('click', () => {\r\n    selectCb('')\r\n  })\r\n  authorContainer.append(authorTextBg).append(authorText)\r\n  container.append(authorContainer)\r\n\r\n  return {\r\n    changeOrientation: (isVertical) => {\r\n      if (isVertical) {\r\n        titleContainer.pos(135, 500)\r\n        tutorialContainer.pos(300, 1200)\r\n        endlessContainer.pos(680, 1200)\r\n        authorContainer.pos(420, 1800)\r\n      }\r\n    },\r\n    onSelect: (cb) => {\r\n      selectCb = cb\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/cover.js","export default () => ({\r\n  tutorialSteps: [\r\n    [2, 2],\r\n    [2, 3],\r\n    [2, 1]\r\n  ],\r\n  title: '#01',\r\n  mapStr: `\r\n    --r--\r\n    -r-r-\r\n    -rrr-\r\n    -r-r-\r\n    --r--\r\n  `\r\n})\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/levels/tutorial-1.js","export default () => ({\r\n  tutorialSteps: [\r\n    [1, 2],\r\n    [3, 2],\r\n    [4, 1],\r\n    [0, 3],\r\n  ],\r\n  title: '#02',\r\n  mapStr: `\r\n    ----b\r\n    -r-pb\r\n    pr-rp\r\n    bp-r-\r\n    b----\r\n  `\r\n})\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/levels/tutorial-2.js","export default () => ({\r\n  tutorialSteps: [\r\n    [1, 3],\r\n    [3, 3],\r\n    [-1, 2],\r\n    [2, 1],\r\n    [2, 2]\r\n  ],\r\n  title: '#03',\r\n  mapStr: `\r\n    --b--\r\n    -b-b-\r\n    -c-p-\r\n    ggwrr\r\n    -g-r-\r\n  `\r\n})\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/levels/tutorial-3.js","import {\r\n  R,\r\n  G,\r\n  B,\r\n} from './consts'\r\n\r\nconst D_PER_LEVEL = 300\r\nconst D_COLOR_COUNT = [0, 3, 5, 7] // the multiplier for how many base colors used in the map\r\nconst D_STEP_BATCH = [0, 8, 5, 0, 3] // the multiplier for how many steps are in a batch (because of symmetry)\r\nconst D_STEP_SAME_POINT = [4, 3, 2] // the multiplier for how many colors has been set in this point\r\n\r\nconst P_SYMMETRY_NONE = 0\r\nconst P_SYMMETRY_H = 0.3\r\nconst P_SYMMETRY_V = 0.5\r\nconst P_SYMMETRY_ROTATE = 0.7\r\nconst P_SYMMETRY_ALL = 0.9\r\nconst P_SYMMETRY_ALL_ROTATE = 1\r\n\r\nconst P_SYMMETRY_NONE_INC = 0.02 / D_PER_LEVEL\r\nconst P_SYMMETRY_H_INC = 0.01 / D_PER_LEVEL\r\nconst P_SYMMETRY_V_INC = 0.005 / D_PER_LEVEL\r\nconst P_SYMMETRY_ROTATE_INC = 0.01 / D_PER_LEVEL\r\nconst P_SYMMETRY_ALL_INC = 0.001 / D_PER_LEVEL\r\nconst P_SYMMETRY_ALL_ROTATE_INC = 0\r\n\r\nconst SYMMETRY_INC_LEVELS = 16\r\nconst FAIL_STEP = 4\r\n\r\nconst P_2_COLOR_D_MIN = D_PER_LEVEL * 4\r\nconst P_3_COLOR_D_MIN = D_PER_LEVEL * 6\r\nconst P_2_COLOR_D_INC = 0.2 / D_PER_LEVEL\r\nconst P_3_COLOR_D_INC = 0.1 / D_PER_LEVEL\r\n\r\nconst SYMMETRY_NONE = 0\r\nconst SYMMETRY_H = 1\r\nconst SYMMETRY_V = 2\r\nconst SYMMETRY_ROTATE = 3\r\nconst SYMMETRY_ALL = 4\r\nconst SYMMETRY_ALL_ROTATE = 5\r\n\r\nconst levelToDifficulty = (level) => {\r\n  return level * D_PER_LEVEL\r\n}\r\n\r\nexport const endless = ({level, timeUsed}) => {\r\n  const difficulty = levelToDifficulty(level)\r\n\r\n  // random utils\r\n  const seed = Math.floor(Math.random() * (1000000000))\r\n  let curSeed = seed\r\n  let curRandMul = 1\r\n  const getRandom = (max) => {\r\n    let prevRandMul = curRandMul\r\n    curRandMul *= max\r\n    if (curRandMul > 1000000000) {\r\n      curSeed = curSeed * 137 % 1000000000\r\n      prevRandMul = curRandMul = 1\r\n    }\r\n    return Math.floor(curSeed / prevRandMul) % max\r\n  }\r\n\r\n  // init map\r\n  const colorMap = []\r\n  for(let j = 0; j < 5; j++) {\r\n    const line = []\r\n    for(let i = 0; i < 5; i++) {\r\n      line.push(0)\r\n    }\r\n    colorMap.push(line)\r\n  }\r\n  const opCountMap = []\r\n  for(let j = 0; j < 5; j++) {\r\n    const line = []\r\n    for(let i = 0; i < 5; i++) {\r\n      line.push(0)\r\n    }\r\n    opCountMap.push(line)\r\n  }\r\n\r\n  // generate symmetry type\r\n  const symmetryRand = getRandom(10) / 10\r\n  let symmetryType = 0\r\n  const symmetryIncLevels = Math.min(level, SYMMETRY_INC_LEVELS)\r\n  if (symmetryRand < P_SYMMETRY_NONE + symmetryIncLevels * P_SYMMETRY_NONE_INC) {\r\n    symmetryType = SYMMETRY_NONE\r\n  } else if (symmetryRand < P_SYMMETRY_H + symmetryIncLevels * P_SYMMETRY_H_INC) {\r\n    symmetryType = SYMMETRY_H\r\n  } else if (symmetryRand < P_SYMMETRY_V + symmetryIncLevels * P_SYMMETRY_V_INC) {\r\n    symmetryType = SYMMETRY_V\r\n  } else if (symmetryRand < P_SYMMETRY_ROTATE + symmetryIncLevels * P_SYMMETRY_ROTATE_INC) {\r\n    symmetryType = SYMMETRY_ROTATE\r\n  } else if (symmetryRand < P_SYMMETRY_ALL + symmetryIncLevels * P_SYMMETRY_ALL_INC) {\r\n    symmetryType = SYMMETRY_ALL\r\n  } else if (symmetryRand < P_SYMMETRY_ALL_ROTATE + symmetryIncLevels * P_SYMMETRY_ALL_ROTATE_INC) {\r\n    symmetryType = SYMMETRY_ALL_ROTATE\r\n  }\r\n\r\n  // generate color type\r\n  const colorKey = [R, G, B][getRandom(3)]\r\n  const colorRand = getRandom(10) / 10\r\n  let colors = [R, G, B]\r\n  let colorType = 1\r\n  const pColor2 = (difficulty - P_2_COLOR_D_MIN) * P_2_COLOR_D_INC\r\n  const pColor3 = (difficulty - P_3_COLOR_D_MIN) * P_3_COLOR_D_INC\r\n  if (colorRand < pColor3) {\r\n    colors = [R, G, B]\r\n    colorType = 3\r\n  } else if (colorRand < pColor2) {\r\n    colors.splice(colors.indexOf(colorKey), 1)\r\n    colorType = 2\r\n  } else {\r\n    colors = [colorKey]\r\n    colorType = 1\r\n  }\r\n\r\n  // generate each step\r\n  let currentD = 0\r\n  // eslint-disable-next-line complexity\r\n  const nextStep = () => {\r\n    const stepColor = colors[getRandom(colorType)]\r\n\r\n    // stat available positions\r\n    const availablePos = []\r\n    for(let j = 0; j < 5; j++) {\r\n      for(let i = 0; i < 5; i++) {\r\n        if (colorMap[j][i] & stepColor) continue\r\n        availablePos.push([i, j])\r\n      }\r\n    }\r\n    if (!availablePos.length) return 0\r\n    const [stepM, stepN] = availablePos[getRandom(availablePos.length)]\r\n    let stepSamePoint = 0\r\n    if (colorMap[stepN][stepM] & R) stepSamePoint++\r\n    if (colorMap[stepN][stepM] & G) stepSamePoint++\r\n    if (colorMap[stepN][stepM] & B) stepSamePoint++\r\n\r\n    // init maps\r\n    const signMap = []\r\n    for(let j = 0; j < 5; j++) {\r\n      const line = []\r\n      for(let i = 0; i < 5; i++) {\r\n        line.push(0)\r\n      }\r\n      signMap.push(line)\r\n    }\r\n    const weightMap = []\r\n    for(let j = 0; j < 5; j++) {\r\n      const line = []\r\n      for(let i = 0; i < 5; i++) {\r\n        line.push(0)\r\n      }\r\n      weightMap.push(line)\r\n    }\r\n\r\n    // construct sign map\r\n    let stepCount = 0\r\n    const setSignMap = (m, n) => {\r\n      if (signMap[n][m]) return\r\n      stepCount++\r\n      signMap[n][m] = 1\r\n    }\r\n    setSignMap(stepM, stepN)\r\n    if (symmetryType === SYMMETRY_H) {\r\n      setSignMap(4 - stepM, stepN)\r\n    } else if (symmetryType === SYMMETRY_V) {\r\n      setSignMap(stepM, 4 - stepN)\r\n    } else if (symmetryType === SYMMETRY_ROTATE) {\r\n      setSignMap(4 - stepM, 4 - stepN)\r\n    } else if (symmetryType === SYMMETRY_ALL) {\r\n      setSignMap(4 - stepM, stepN)\r\n      setSignMap(stepM, 4 - stepN)\r\n      setSignMap(4 - stepM, 4 - stepN)\r\n    } else if (symmetryType === SYMMETRY_ALL_ROTATE) {\r\n      setSignMap(4 - stepN, stepM)\r\n      setSignMap(stepN, 4 - stepM)\r\n      setSignMap(4 - stepM, 4 - stepN)\r\n    }\r\n\r\n    // extend weight map\r\n    let stepD = 0\r\n    for(let j = 0; j < 5; j++) {\r\n      for(let i = 0; i < 5; i++) {\r\n        if (signMap[j - 1] && signMap[j - 1][i]) stepD += (++weightMap[j][i]) + opCountMap[j][i]\r\n        if (signMap[j + 1] && signMap[j + 1][i]) stepD += (++weightMap[j][i]) + opCountMap[j][i]\r\n        if (signMap[j][i - 1]) stepD += (++weightMap[j][i]) + opCountMap[j][i]\r\n        if (signMap[j][i + 1]) stepD += (++weightMap[j][i]) + opCountMap[j][i]\r\n        if (signMap[j][i]) stepD += (++weightMap[j][i]) + opCountMap[j][i]\r\n      }\r\n    }\r\n\r\n    // check and write to map\r\n    stepD *= D_COLOR_COUNT[colorType] * D_STEP_BATCH[stepCount] * D_STEP_SAME_POINT[stepSamePoint]\r\n    if (stepD + currentD <= difficulty || currentD === 0) {\r\n      for(let j = 0; j < 5; j++) {\r\n        for(let i = 0; i < 5; i++) {\r\n          if (weightMap[j][i] % 2) {\r\n            colorMap[j][i] ^= stepColor\r\n          }\r\n          opCountMap[j][i] += weightMap[j][i]\r\n        }\r\n      }\r\n    } else {\r\n      stepD = 0\r\n    }\r\n    return stepD\r\n  }\r\n  let allowFailStep = FAIL_STEP\r\n  while (currentD < difficulty) {\r\n    const stepD = nextStep()\r\n    if (!stepD && !--allowFailStep) break\r\n    currentD += stepD\r\n  }\r\n\r\n  const levelObj = {\r\n    timeUsed,\r\n    title: '#' + (level < 10 ? '0' + level : level),\r\n    seed,\r\n    difficulty: currentD,\r\n    map: colorMap\r\n  }\r\n  return levelObj\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/generator.js"],"sourceRoot":""}